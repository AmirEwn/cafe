<!DOCTYPE html>
<html lang="fa" dir="rtl">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>پنل مدیریت کافه | کافه‌یاب</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Vazirmatn:wght@400;600;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

    <style>
        :root {
            --primary: #6d28d9;
            --primary-light: #8b5cf6;
            --secondary: #f59e0b;
            --dark: #1e293b;
            --light: #f8fafc;
            --gray: #64748b;
            --gray-light: #e2e8f0;
            --success: #10b981;
            --danger: #ef4444;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Vazirmatn', sans-serif;
            background-color: #f5f7fa;
            color: var(--dark);
            line-height: 1.6;
        }

        .header {
            background-color: white;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.08);
            position: sticky;
            top: 0;
            z-index: 100;
            transition: all 0.3s;
        }

        .header.scrolled {
            padding: 5px 0;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }

        .navbar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 0;
        }

        .logo {
            font-size: 24px;
            font-weight: 800;
            color: var(--primary);
            text-decoration: none;
        }

        .nav-links {
            display: flex;
            list-style: none;
            gap: 25px;
        }

        .nav-links a {
            text-decoration: none;
            color: var(--dark);
            font-weight: 500;
            transition: color 0.3s;
        }

        .nav-links a:hover {
            color: var(--primary);
        }

        .auth-buttons {
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .user-name {
            font-weight: 600;
        }

        .btn {
            display: inline-block;
            padding: 8px 20px;
            border-radius: 8px;
            text-decoration: none;
            font-weight: 600;
            transition: all 0.3s;
            cursor: pointer;
            border: none;
        }

        .btn-primary {
            background-color: var(--primary);
            color: white;
        }

        .btn-primary:hover {
            background-color: var(--primary-light);
        }

        .btn-outline {
            background-color: transparent;
            border: 1px solid var(--primary);
            color: var(--primary);
        }

        .btn-outline:hover {
            background-color: var(--primary);
            color: white;
        }

        .btn-danger {
            background-color: var(--danger);
            color: white;
        }

        .btn-danger:hover {
            background-color: #dc2626;
        }

        .btn-sm {
            padding: 6px 12px;
            font-size: 14px;
        }

        .mobile-menu-btn {
            display: none;
            font-size: 24px;
            cursor: pointer;
        }

        .cafe-panel {
            padding: 30px 0;
        }

        .panel-wrapper {
            display: flex;
            gap: 25px;
        }

        .panel-sidebar {
            flex: 0 0 280px;
            background-color: white;
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
            padding: 25px;
            height: fit-content;
        }

        .cafe-info {
            text-align: center;
            margin-bottom: 30px;
            padding-bottom: 20px;
            border-bottom: 1px solid var(--gray-light);
        }

        .cafe-avatar {
            position: relative;
            width: 100px;
            height: 100px;
            margin: 0 auto 15px;
            border-radius: 50%;
            overflow: hidden;
        }

        .cafe-avatar img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .edit-avatar {
            position: absolute;
            bottom: 0;
            right: 0;
            background-color: var(--primary);
            color: white;
            width: 32px;
            height: 32px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            border: none;
            cursor: pointer;
        }

        .cafe-info h3 {
            font-size: 20px;
            margin-bottom: 8px;
        }

        .rating {
            color: var(--secondary);
            font-size: 14px;
        }

        .panel-menu {
            list-style: none;
        }

        .panel-menu li {
            margin-bottom: 8px;
        }

        .panel-menu a {
            display: flex;
            align-items: center;
            padding: 12px 15px;
            border-radius: 8px;
            text-decoration: none;
            color: var(--dark);
            transition: all 0.3s;
            position: relative;
        }

        .panel-menu a:hover {
            background-color: var(--gray-light);
        }

        .panel-menu .active a {
            background-color: var(--primary);
            color: white;
        }

        .panel-menu i {
            margin-left: 10px;
            width: 20px;
            text-align: center;
        }

        .badge {
            background-color: var(--danger);
            color: white;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            margin-right: auto;
        }

        .panel-content {
            flex: 1;
            background-color: white;
            border-radius: 12px;
            box-shadow: 0 4px 20px rgba(0, 0, 0, 0.08);
            overflow: hidden;
        }

        .panel-section {
            display: none;
            padding: 30px;
        }

        .panel-section.active {
            display: block;
        }

        .section-header {
            margin-bottom: 30px;
        }

        .section-header h2 {
            font-size: 24px;
            margin-bottom: 8px;
            position: relative;
            display: inline-block;
        }

        .section-header h2::after {
            content: '';
            position: absolute;
            bottom: -5px;
            right: 0;
            width: 50px;
            height: 3px;
            background-color: var(--primary);
            border-radius: 2px;
        }

        .section-header p {
            color: var(--gray);
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background-color: white;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.05);
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .stat-icon {
            width: 60px;
            height: 60px;
            border-radius: 12px;
            background-color: rgba(109, 40, 217, 0.1);
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--primary);
            font-size: 24px;
        }

        .stat-info h3 {
            font-size: 24px;
            margin-bottom: 5px;
        }

        .stat-info p {
            color: var(--gray);
            font-size: 14px;
        }

        .panel-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 25px;
            margin-bottom: 30px;
        }

        .chart-container {
            background-color: white;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.05);
        }

        .chart-container h3 {
            margin-bottom: 15px;
            font-size: 18px;
        }

        .big-chart {
            grid-column: 1 / -1;
        }

        .recent-orders h3 {
            margin-bottom: 15px;
            font-size: 18px;
        }

        .table-responsive {
            overflow-x: auto;
        }

        .table {
            width: 100%;
            border-collapse: collapse;
        }

        .table th,
        .table td {
            padding: 12px 15px;
            text-align: right;
            border-bottom: 1px solid var(--gray-light);
        }

        .table th {
            background-color: #f8fafc;
            font-weight: 600;
        }

        .status {
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
        }

        .status.completed {
            background-color: rgba(16, 185, 129, 0.1);
            color: var(--success);
        }

        .status.pending {
            background-color: rgba(245, 158, 11, 0.1);
            color: var(--secondary);
        }

        .status.canceled {
            background-color: rgba(239, 68, 68, 0.1);
            color: var(--danger);
        }

        /* مدیریت منو - استایل‌های جدید */
        .menu-management-tabs {
            margin-top: 20px;
        }

        .tabs-header {
            display: flex;
            list-style: none;
            border-bottom: 1px solid var(--gray-light);
            margin-bottom: 25px;
        }

        .tabs-header li {
            padding: 12px 25px;
            cursor: pointer;
            font-weight: 600;
            border-bottom: 3px solid transparent;
            transition: all 0.3s;
        }

        .tabs-header li.active {
            color: var(--primary);
            border-bottom-color: var(--primary);
        }

        .tabs-content {
            padding: 0 10px;
        }

        .tab-pane {
            display: none;
        }

        .tab-pane.active {
            display: block;
        }

        .tab-actions {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
        }

        .search-box {
            display: flex;
            align-items: center;
            background-color: #f8fafc;
            border-radius: 8px;
            overflow: hidden;
            width: 300px;
        }

        .search-box input {
            flex: 1;
            border: none;
            padding: 10px 15px;
            background: transparent;
            outline: none;
        }

        .search-box button {
            border-radius: 0;
            border: none;
            padding: 10px 15px;
        }

        .categories-list,
        .menu-items-list {
            display: grid;
            gap: 15px;
        }

        .category-item,
        .menu-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px;
            background-color: white;
            border-radius: 12px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
            border: 1px solid var(--gray-light);
        }

        .category-details h3,
        .item-details h3 {
            margin-bottom: 5px;
        }

        .category-details p,
        .item-category,
        .item-description {
            color: var(--gray);
            font-size: 14px;
        }

        .item-price {
            font-weight: 600;
            color: var(--primary);
        }

        .category-actions,
        .item-actions {
            display: flex;
            gap: 10px;
        }

        .item-status {
            padding: 4px 10px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
        }

        .item-status.active {
            background-color: rgba(16, 185, 129, 0.1);
            color: var(--success);
        }

        .item-status.inactive {
            background-color: rgba(239, 68, 68, 0.1);
            color: var(--danger);
        }

        /* مودال‌ها */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.5);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }

        .modal.active {
            display: flex;
        }

        .modal-content {
            background-color: white;
            border-radius: 12px;
            width: 90%;
            max-width: 600px;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
        }

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 20px 25px;
            border-bottom: 1px solid var(--gray-light);
        }

        .modal-header h3 {
            font-size: 20px;
        }

        .close-modal {
            background: none;
            border: none;
            font-size: 24px;
            cursor: pointer;
            color: var(--gray);
        }

        .modal-body {
            padding: 25px;
        }

        .modal-footer {
            display: flex;
            justify-content: flex-end;
            gap: 10px;
            padding: 20px 25px;
            border-top: 1px solid var(--gray-light);
        }

        /* فرم‌ها */
        .form-group {
            margin-bottom: 20px;
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
        }

        /* input,
        select,
        textarea {
            width: 100%;
            padding: 10px 15px;
            border: 1px solid var(--gray-light);
            border-radius: 8px;
            font-family: inherit;
            transition: border-color 0.3s;
        } */

        /* input:focus,
        select:focus,
        textarea:focus {
            outline: none;
            border-color: var(--primary);
        } */

        .image-upload {
            border: 2px dashed var(--gray-light);
            border-radius: 8px;
            padding: 20px;
            text-align: center;
            transition: border-color 0.3s;
        }

        .image-upload:hover {
            border-color: var(--primary);
        }

        .upload-label {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 10px;
            cursor: pointer;
            color: var(--gray);
        }

        .upload-label i {
            font-size: 24px;
        }

        .radio-group {
            display: flex;
            gap: 20px;
        }

        .radio-container {
            display: flex;
            align-items: center;
            cursor: pointer;
        }

        .radio-container input {
            width: auto;
            margin-left: 8px;
        }

        .radio-checkmark {
            width: 18px;
            height: 18px;
            border-radius: 50%;
            border: 2px solid var(--gray);
            position: relative;
            margin-left: 8px;
        }

        .radio-container input:checked+.radio-checkmark {
            border-color: var(--primary);
        }

        .radio-container input:checked+.radio-checkmark::after {
            content: '';
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background-color: var(--primary);
        }

        /* تب‌های مدیریت منو */
        .tab-buttons {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-bottom: 30px;
            flex-wrap: wrap;
        }

        .tab-btn {
            padding: 12px 25px;
            border-radius: 30px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
            border: none;
        }

        .tab-btn.tab-active {
            background-color: var(--primary);
            color: white;
        }

        .tab-btn:not(.tab-active) {
            background-color: var(--gray-light);
            color: var(--dark);
        }

        .tab-content {
            display: none;
        }

        .tab-content.active {
            display: block;
        }

        /* کارت‌های دسته‌بندی */
        .categorys-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .category-card {
            background-color: white;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.05);
            border: 1px solid var(--gray-light);
            transition: transform 0.3s, box-shadow 0.3s;
        }

        .category-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
        }

        .category-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 15px;
        }

        .category-icon {
            width: 50px;
            height: 50px;
            border-radius: 10px;
            background-color: rgba(109, 40, 217, 0.1);
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--primary);
            font-size: 20px;
            transition: all 0.3s;
        }

        .category-actions {
            display: flex;
            gap: 10px;
        }

        .category-actions button {
            background: none;
            border: none;
            cursor: pointer;
            font-size: 16px;
            transition: color 0.3s;
        }

        .edit-category-btn {
            color: var(--primary);
        }

        .delete-category-btn {
            color: var(--danger);
        }

        .category-card h4 {
            font-size: 18px;
            margin-bottom: 10px;
        }

        .category-card p {
            color: var(--gray);
            margin-bottom: 15px;
            font-size: 14px;
        }

        .category-footer {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .category-footer span {
            font-size: 14px;
            color: var(--gray);
        }

        .status-badge {
            padding: 4px 10px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
        }

        .status-badge.active {
            background-color: rgba(16, 185, 129, 0.1);
            color: var(--success);
        }

        .status-badge.inactive {
            background-color: rgba(239, 68, 68, 0.1);
            color: var(--danger);
        }

        /* جدول آیتم‌های منو */
        .menu-items-table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 30px;
        }

        .menu-items-table th,
        .menu-items-table td {
            padding: 15px;
            text-align: right;
            border-bottom: 1px solid var(--gray-light);
        }

        .menu-items-table th {
            background-color: #f8fafc;
            font-weight: 600;
        }

        .menu-items-table tr:hover {
            background-color: #f8fafc;
        }

        .item-cell {
            display: flex;
            align-items: center;
        }

        .item-cell img {
            width: 50px;
            height: 50px;
            border-radius: 8px;
            object-fit: cover;
            margin-left: 15px;
        }

        .item-info h4 {
            margin-bottom: 5px;
        }

        .item-info p {
            color: var(--gray);
            font-size: 14px;
        }

        .table-actions {
            display: flex;
            gap: 10px;
        }

        .table-actions button {
            background: none;
            border: none;
            cursor: pointer;
            font-size: 16px;
            transition: color 0.3s;
        }

        .edit-item-btn {
            color: var(--primary);
        }

        .delete-item-btn {
            color: var(--danger);
        }

        /* کارت‌های منو */
        .menus-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
        }

        .menu-card {
            background-color: white;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.05);
            border: 1px solid var(--gray-light);
            transition: transform 0.3s, box-shadow 0.3s;
        }

        .menu-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
        }

        .menu-header {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            margin-bottom: 15px;
        }

        .menu-header h4 {
            font-size: 18px;
        }

        .menu-actions {
            display: flex;
            gap: 10px;
        }

        .menu-actions button {
            background: none;
            border: none;
            cursor: pointer;
            font-size: 16px;
            transition: color 0.3s;
        }

        .edit-menu-btn {
            color: var(--primary);
        }

        .delete-menu-btn {
            color: var(--danger);
        }

        .menu-card p {
            color: var(--gray);
            margin-bottom: 15px;
        }

        .menu-footer {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }

        .menu-actions-buttons {
            display: flex;
            gap: 10px;
        }

        .menu-actions-buttons button {
            flex: 1;
            padding: 8px 15px;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }

        .view-menu-btn {
            background-color: var(--primary);
            color: white;
            border: none;
        }

        .copy-menu-btn {
            background-color: transparent;
            border: 1px solid var(--primary);
            color: var(--primary);
        }

        /* بخش ساخت منو */
        .menu-builder-container {
            display: grid;
            grid-template-columns: 250px 1fr 300px;
            gap: 20px;
            margin-bottom: 30px;
        }

        .builder-tools {
            background-color: #f8fafc;
            border-radius: 12px;
            padding: 20px;
        }

        .tool-section {
            margin-bottom: 30px;
        }

        .tool-section h3 {
            font-size: 16px;
            margin-bottom: 15px;
            color: var(--dark);
        }

        .menu-items-list {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .menu-item-draggable {
            padding: 12px 15px;
            background-color: white;
            border-radius: 8px;
            border: 1px solid var(--gray-light);
            cursor: grab;
            transition: all 0.3s;
        }

        .menu-item-draggable:hover {
            border-color: var(--primary);
            transform: translateY(-2px);
        }

        .menu-item-draggable.dragging {
            opacity: 0.5;
        }

        .appearance-settings {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .background-upload {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .upload-btn {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            padding: 10px 15px;
            background-color: white;
            border: 1px solid var(--gray-light);
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .upload-btn:hover {
            border-color: var(--primary);
            color: var(--primary);
        }

        .menu-preview {
            background-color: white;
            border-radius: 12px;
            padding: 30px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.05);
            border: 1px solid var(--gray-light);
        }

        .preview-container {
            min-height: 600px;
            padding: 30px;
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
        }

        .menu-header {
            text-align: center;
            margin-bottom: 30px;
        }

        .menu-header h2 {
            font-size: 28px;
            margin-bottom: 10px;
            color: var(--primary);
        }

        .menu-header p {
            color: var(--gray);
        }

        .menu-body {
            min-height: 400px;
        }

        .menu-category {
            margin-bottom: 30px;
        }

        .menu-category h3 {
            font-size: 20px;
            margin-bottom: 15px;
            color: var(--dark);
            border-bottom: 2px solid var(--primary);
            padding-bottom: 5px;
        }

        .menu-items {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .menu-item {
            display: flex;
            justify-content: space-between;
            align-items: flex-start;
            padding: 15px;
            border-radius: 8px;
            transition: background-color 0.3s;
        }

        .menu-item:hover {
            background-color: #f8fafc;
        }

        .item-details h4 {
            font-size: 16px;
            margin-bottom: 5px;
        }

        .item-details p {
            color: var(--gray);
            font-size: 14px;
        }

        .item-price {
            font-weight: 600;
            color: var(--primary);
        }

        .menu-divider {
            height: 1px;
            background-color: var(--gray-light);
            margin: 20px 0;
        }

        .menu-footer {
            text-align: center;
            margin-top: 30px;
            padding-top: 20px;
            border-top: 1px solid var(--gray-light);
            color: var(--gray);
        }

        .item-settings {
            background-color: #f8fafc;
            border-radius: 12px;
            padding: 20px;
        }

        .settings-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .settings-header h3 {
            font-size: 18px;
        }

        .close-settings {
            background: none;
            border: none;
            font-size: 20px;
            cursor: pointer;
            color: var(--gray);
        }

        .settings-body {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .builder-actions {
            display: flex;
            justify-content: center;
            gap: 15px;
        }

        .drop-hover {
            background-color: rgba(109, 40, 217, 0.05);
            border: 2px dashed var(--primary);
        }

        /* انیمیشن‌ها */
        .category-card.animated,
        .cafe-card.animated,
        .feature-card.animated,
        .testimonial-card.animated,
        .blog-card.animated {
            animation: fadeInUp 0.6s ease-out;
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        /* فیلترهای زمانی */
        .time-filters {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 25px;
            flex-wrap: wrap;
            gap: 15px;
        }

        .filter-buttons {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .filter-buttons .btn.active {
            background-color: var(--primary);
            color: white;
        }

        .date-picker {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .date-picker input {
            width: auto;
        }

        .sales-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .sales-stats .stat-card {
            text-align: center;
            flex-direction: column;
            gap: 10px;
        }

        .stat-value {
            font-size: 28px;
            font-weight: 700;
            color: var(--primary);
        }

        .stat-change {
            font-size: 14px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 5px;
        }

        .stat-change.up {
            color: var(--success);
        }

        .stat-change.down {
            color: var(--danger);
        }

        .export-actions {
            display: flex;
            justify-content: center;
            gap: 15px;
            margin-top: 30px;
        }

        /* رسپانسیو */
        @media (max-width: 1200px) {
            .menu-builder-container {
                grid-template-columns: 1fr;
            }

            .item-settings {
                order: 3;
            }
        }

        @media (max-width: 992px) {
            .panel-wrapper {
                flex-direction: column;
            }

            .panel-sidebar {
                flex: 1;
            }

            .panel-row {
                grid-template-columns: 1fr;
            }

            .form-row {
                grid-template-columns: 1fr;
            }
        }

        @media (max-width: 768px) {

            .nav-links,
            .auth-buttons {
                display: none;
            }

            .nav-links.active,
            .auth-buttons.active {
                display: flex;
                flex-direction: column;
                position: absolute;
                top: 100%;
                right: 0;
                background-color: white;
                width: 100%;
                padding: 20px;
                box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
                z-index: 100;
            }

            .nav-links.active {
                gap: 15px;
            }

            .auth-buttons.active {
                flex-direction: column;
                gap: 10px;
                border-top: 1px solid var(--gray-light);
                padding-top: 15px;
            }

            .mobile-menu-btn {
                display: block;
            }

            .mobile-menu-btn.active i::before {
                content: '\f00d';
            }

            .stats-grid {
                grid-template-columns: 1fr 1fr;
            }

            .categorys-grid,
            .menus-grid {
                grid-template-columns: 1fr;
            }

            .tab-actions {
                flex-direction: column;
                gap: 15px;
                align-items: flex-start;
            }

            .search-box {
                width: 100%;
            }

            .category-item,
            .menu-item {
                flex-direction: column;
                align-items: flex-start;
                gap: 15px;
            }

            .category-actions,
            .item-actions {
                align-self: flex-end;
            }

            .time-filters {
                flex-direction: column;
                align-items: flex-start;
            }

            .date-picker {
                width: 100%;
                justify-content: space-between;
            }

            .date-picker input {
                flex: 1;
            }
        }

        @media (max-width: 576px) {
            .stats-grid {
                grid-template-columns: 1fr;
            }

            .tabs-header {
                flex-direction: column;
            }

            .tabs-header li {
                text-align: center;
                border-bottom: none;
                border-right: 3px solid transparent;
            }

            .tabs-header li.active {
                border-bottom-color: transparent;
                border-right-color: var(--primary);
            }

            .sales-stats {
                grid-template-columns: 1fr;
            }

            .export-actions {
                flex-direction: column;
            }
        }


        .qr-management-container {
            padding: 20px 0;
        }

        .qr-filters {
            display: flex;
            gap: 15px;
            margin-bottom: 25px;
            flex-wrap: wrap;
            align-items: end;
        }

        .filter-group {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }

        .filter-group label {
            font-size: 14px;
            font-weight: 600;
            color: var(--dark);
        }

        .qr-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 25px 0;
        }

        .action-buttons {
            display: flex;
            gap: 10px;
        }

        .qr-preview-section {
            margin-top: 40px;
            padding: 25px;
            background-color: #f8fafc;
            border-radius: 12px;
            border: 1px solid var(--gray-light);
        }

        .qr-preview-section h3 {
            margin-bottom: 20px;
            font-size: 20px;
            color: var(--dark);
        }

        .qr-preview {
            display: flex;
            gap: 30px;
            align-items: flex-start;
        }

        .qr-code-placeholder {
            width: 200px;
            height: 200px;
            background: white;
            border: 2px solid var(--gray-light);
            border-radius: 12px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            color: var(--gray);
            padding: 10px;
        }

        .qr-code-placeholder img {
            width: 100%;
            height: 100%;
            object-fit: contain;
        }

        .qr-code-placeholder i {
            font-size: 48px;
            margin-bottom: 10px;
        }

        .qr-info {
            flex: 1;
        }

        .qr-info h4 {
            font-size: 18px;
            margin-bottom: 15px;
            color: var(--primary);
        }

        .qr-info p {
            margin-bottom: 8px;
            font-size: 14px;
        }

        .qr-info p strong {
            color: var(--dark);
        }

        .qr-actions {
            display: flex;
            gap: 10px;
            margin-top: 20px;
            flex-wrap: wrap;
        }

        .qr-thumbnail {
            border-radius: 8px;
            transition: transform 0.2s;
        }

        .qr-thumbnail:hover {
            transform: scale(1.1);
        }

        .alert {
            padding: 12px 20px;
            border-radius: 8px;
            margin-bottom: 15px;
            border: 1px solid transparent;
        }

        .alert-success {
            background-color: rgba(16, 185, 129, 0.1);
            border-color: rgba(16, 185, 129, 0.2);
            color: var(--success);
        }

        .alert-danger {
            background-color: rgba(239, 68, 68, 0.1);
            border-color: rgba(239, 68, 68, 0.2);
            color: var(--danger);
        }

        .btn-warning {
            background-color: var(--secondary);
            color: white;
        }

        .btn-warning:hover {
            background-color: #e69500;
        }

        @media (max-width: 768px) {
            .qr-filters {
                flex-direction: column;
                align-items: stretch;
            }

            .qr-preview {
                flex-direction: column;
            }

            .qr-code-placeholder {
                width: 100%;
                max-width: 200px;
                margin: 0 auto;
            }

            .action-buttons {
                flex-direction: column;
            }
        }
    </style>
</head>

<body>
    <!-- هدر -->
    <header class="header">
        <div class="container">
            <nav class="navbar">
                <a href="homepage.html" class="logo">کافه‌یاب</a>
                <ul class="nav-links">
                    <li><a href="homepage.html">بازگشت به سایت</a></li>
                </ul>
                <div class="auth-buttons">
                    <span class="user-name">مدیریت کافه کتابخانه</span>
                    <a href="#" class="btn btn-outline">خروج</a>
                </div>
                <div class="mobile-menu-btn">
                    <i class="fas fa-bars"></i>
                </div>
            </nav>
        </div>
    </header>

    <!-- پنل مدیریت -->
    <div class="cafe-panel">
        <div class="container">
            <div class="panel-wrapper">
                <!-- سایدبار -->
                <aside class="panel-sidebar">
                    <div class="cafe-info">
                        <div class="cafe-avatar">
                            <img src="https://images.unsplash.com/photo-1554118811-1e0d58224f24?ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D&auto=format&fit=crop&w=1470&q=80"
                                alt="کافه کتابخانه">
                            <button class="edit-avatar"><i class="fas fa-camera"></i></button>
                        </div>
                        <h3>کافه کتابخانه</h3>
                        <p class="rating">
                            <i class="fas fa-star"></i>
                            4.8 (124 نظر)
                        </p>
                    </div>

                    <ul class="panel-menu">
                        <li>
                            <a href="#dashboard">
                                <i class="fas fa-tachometer-alt"></i>
                                پیشخوان
                            </a>
                        </li>
                        <li>
                            <a href="#edit-info">
                                <i class="fas fa-edit"></i>
                                ویرایش اطلاعات
                            </a>
                        </li>
                        <li>
                            <a href="#menu-builder">
                                <i class="fas fa-layer-group"></i>
                                ساخت منو
                            </a>
                        </li>
                        <li>
                            <a href="#manageqr">
                                <i class="fas fa-qrcode"></i> مدیریت QR
                            </a>
                        </li>

                        <li class="active">
                            <a href="#menu-management">
                                <i class="fas fa-utensils"></i>
                                مدیریت منو
                            </a>
                        </li>
                        <li>
                            <a href="#sales-analysis">
                                <i class="fas fa-chart-line"></i>
                                تحلیل فروش
                            </a>
                        </li>
                        <li>
                            <a href="#reviews">
                                <i class="fas fa-comment-alt"></i>
                                نظرات کاربران
                                <span class="badge">12</span>
                            </a>
                        </li>
                        <li>
                            <a href="#reservations">
                                <i class="fas fa-calendar-check"></i>
                                رزروها
                                <span class="badge">5</span>
                            </a>
                        </li>
                        <li>
                            <a href="#settings">
                                <i class="fas fa-cog"></i>
                                تنظیمات
                            </a>
                        </li>
                    </ul>
                </aside>

                <!-- محتوای اصلی -->
                <main class="panel-content">
                    <!-- بخش پیشخوان -->
                    <section id="dashboard" class="panel-section">
                        <div class="section-header">
                            <h2>پیشخوان مدیریت</h2>
                            <p>خلاصه فعالیت‌ها و آمار کافه</p>
                        </div>

                        <div class="stats-grid">
                            <div class="stat-card">
                                <div class="stat-icon">
                                    <i class="fas fa-users"></i>
                                </div>
                                <div class="stat-info">
                                    <h3>124</h3>
                                    <p>بازدید امروز</p>
                                </div>
                            </div>

                            <div class="stat-card">
                                <div class="stat-icon">
                                    <i class="fas fa-shopping-bag"></i>
                                </div>
                                <div class="stat-info">
                                    <h3>28</h3>
                                    <p>سفارشات امروز</p>
                                </div>
                            </div>

                            <div class="stat-card">
                                <div class="stat-icon">
                                    <i class="fas fa-coins"></i>
                                </div>
                                <div class="stat-info">
                                    <h3>3,450,000</h3>
                                    <p>درآمد امروز (تومان)</p>
                                </div>
                            </div>

                            <div class="stat-card">
                                <div class="stat-icon">
                                    <i class="fas fa-star"></i>
                                </div>
                                <div class="stat-info">
                                    <h3>4.8</h3>
                                    <p>میانگین امتیاز</p>
                                </div>
                            </div>
                        </div>

                        <div class="panel-row">
                            <div class="chart-container">
                                <h3>آمار بازدید 7 روز اخیر</h3>
                                <canvas id="visitsChart"></canvas>
                            </div>

                            <div class="chart-container">
                                <h3>محبوب‌ترین آیتم‌های منو</h3>
                                <canvas id="popularItemsChart"></canvas>
                            </div>
                        </div>

                        <div class="recent-orders">
                            <h3>سفارشات اخیر</h3>
                            <div class="table-responsive">
                                <table class="table">
                                    <thead>
                                        <tr>
                                            <th>شماره سفارش</th>
                                            <th>مشتری</th>
                                            <th>تاریخ</th>
                                            <th>مبلغ</th>
                                            <th>وضعیت</th>
                                            <th>عملیات</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <td>#1254</td>
                                            <td>محمد احمدی</td>
                                            <td>1402/05/15 - 14:30</td>
                                            <td>125,000 تومان</td>
                                            <td><span class="status completed">تکمیل شده</span></td>
                                            <td>
                                                <button class="btn btn-sm btn-outline">جزئیات</button>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>#1253</td>
                                            <td>فاطمه محمدی</td>
                                            <td>1402/05/15 - 13:45</td>
                                            <td>87,000 تومان</td>
                                            <td><span class="status completed">تکمیل شده</span></td>
                                            <td>
                                                <button class="btn btn-sm btn-outline">جزئیات</button>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>#1252</td>
                                            <td>علی رضایی</td>
                                            <td>1402/05/15 - 12:20</td>
                                            <td>210,000 تومان</td>
                                            <td><span class="status pending">در حال آماده‌سازی</span></td>
                                            <td>
                                                <button class="btn btn-sm btn-outline">جزئیات</button>
                                            </td>
                                        </tr>
                                        <tr>
                                            <td>#1251</td>
                                            <td>زهرا حسینی</td>
                                            <td>1402/05/15 - 11:10</td>
                                            <td>65,000 تومان</td>
                                            <td><span class="status canceled">لغو شده</span></td>
                                            <td>
                                                <button class="btn btn-sm btn-outline">جزئیات</button>
                                            </td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </section>

                    <!-- بخش ویرایش اطلاعات -->
                    <section id="edit-info" class="panel-section">
                        <div class="section-header">
                            <h2>ویرایش اطلاعات کافه</h2>
                            <p>اطلاعات عمومی و مشخصات کافه را به روزرسانی کنید</p>
                        </div>

                        <div id="test">
                            <div>
                                <label for="category-test">تست کتگوری</label>
                                <input type="text" name="category-test" id="category-test"
                                    class="w-50 px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500 transition">
                                <button id="send-category-test"
                                    class="px-6 py-3 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition">send
                                    category test</button>
                            </div>
                            <div>
                                <label for="feature-test">تست فیچر</label>
                                <input type="text" name="feature-test" id="feature-test"
                                    class="w-50 px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500 transition">
                                <button id="send-feature-test"
                                    class="px-6 py-3 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition">send
                                    feature test</button>
                            </div>
                        </div>


                        <form class="edit-form" id="edit-user">
                            <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                                <div class="form-group">
                                    <label for="cafe-name" class="block text-sm font-medium text-gray-700 mb-2">نام
                                        کافه</label>
                                    <input type="text" id="cafe-name" value="کافه کتابخانه"
                                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500 transition">
                                </div>
                                <div class="form-group">
                                    <label for="cafe-category"
                                        class="block text-sm font-medium text-gray-700 mb-2">دسته‌بندی</label>
                                    <select id="cafe-category"
                                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500 transition">
                                        <option value="traditional">کافه سنتی</option>
                                        <option value="work" selected>کافه کار</option>
                                        <option value="book">کافه کتاب</option>
                                        <option value="music">کافه موزیک</option>
                                        <option value="restaurant">کافه رستوران</option>
                                        <option value="pets">کافه حیوانات</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label for="cafe-features"
                                        class="block text-sm font-medium text-gray-700 mb-2">ویژگی‌ها</label>
                                    <select id="cafe-fetures"
                                        class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500 transition">
                                        <option value="0">انتخاب کنید</option>
                                    </select>
                                </div>
                            </div>
                            <div class="form-group mb-6">
                                <label class="block text-sm font-medium text-gray-700 mb-2">موقعیت روی نقشه</label>
                                <div id="map" class="rounded-lg border border-gray-300" style="height: 400px;"></div>

                                <!-- فیلدهای مخفی -->
                                <input type="hidden" id="lat" name="lat">
                                <input type="hidden" id="long" name="long">
                            </div>




                            <div class="form-group mb-6">
                                <label for="cafe-address"
                                    class="block text-sm font-medium text-gray-700 mb-2">آدرس</label>
                                <input type="text" id="cafe-address" value="تهران، خیابان انقلاب، بین دانشگاه و فلسطین"
                                    class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500 transition">
                            </div>
                            <div class="form-group mb-6">
                                <label for="cafe-description"
                                    class="block text-sm font-medium text-gray-700 mb-2">توضیحات کافه</label>
                                <textarea id="cafe-description" rows="5"
                                    class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500 transition">کافه‌ای دنج با کتاب‌های متنوع و فضای آرام برای مطالعه. مناسب برای دانشجویان و علاقه‌مندان به کتاب. وای‌فای پرسرعت و محیطی آرام برای کار و مطالعه.</textarea>
                            </div>

                            <div class="form-group mb-6">
                                <label class="block text-sm font-medium text-gray-700 mb-2">ساعات کاری</label>

                                <div class="space-y-4">
                                    <div class="flex items-center justify-between">
                                        <span class="text-gray-700 w-32">شنبه</span>
                                        <div class="flex items-center space-x-2 space-x-reverse">
                                            <input type="time" value="09:00"
                                                class="px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500 transition">
                                            <span class="text-gray-500">تا</span>
                                            <input type="time" value="18:00"
                                                class="px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500 transition">
                                        </div>
                                    </div>

                                    <div class="flex items-center justify-between">
                                        <span class="text-gray-700 w-32">یکشنبه</span>
                                        <div class="flex items-center space-x-2 space-x-reverse">
                                            <input type="time" value="09:00"
                                                class="px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500 transition">
                                            <span class="text-gray-500">تا</span>
                                            <input type="time" value="18:00"
                                                class="px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500 transition">
                                        </div>
                                    </div>

                                    <div class="flex items-center justify-between">
                                        <span class="text-gray-700 w-32">دوشنبه</span>
                                        <div class="flex items-center space-x-2 space-x-reverse">
                                            <input type="time" value="09:00"
                                                class="px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500 transition">
                                            <span class="text-gray-500">تا</span>
                                            <input type="time" value="18:00"
                                                class="px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500 transition">
                                        </div>
                                    </div>

                                    <div class="flex items-center justify-between">
                                        <span class="text-gray-700 w-32">سه‌شنبه</span>
                                        <div class="flex items-center space-x-2 space-x-reverse">
                                            <input type="time" value="09:00"
                                                class="px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500 transition">
                                            <span class="text-gray-500">تا</span>
                                            <input type="time" value="18:00"
                                                class="px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500 transition">
                                        </div>
                                    </div>

                                    <div class="flex items-center justify-between">
                                        <span class="text-gray-700 w-32">چهارشنبه</span>
                                        <div class="flex items-center space-x-2 space-x-reverse">
                                            <input type="time" value="09:00"
                                                class="px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500 transition">
                                            <span class="text-gray-500">تا</span>
                                            <input type="time" value="18:00"
                                                class="px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500 transition">
                                        </div>
                                    </div>

                                    <div class="flex items-center justify-between">
                                        <span class="text-gray-700 w-32">پنجشنبه</span>
                                        <div class="flex items-center space-x-2 space-x-reverse">
                                            <input type="time" value="09:00"
                                                class="px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500 transition">
                                            <span class="text-gray-500">تا</span>
                                            <input type="time" value="22:00"
                                                class="px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500 transition">
                                        </div>
                                    </div>

                                    <div class="flex items-center justify-between">
                                        <span class="text-gray-700 w-32">جمعه</span>
                                        <div class="flex items-center space-x-2 space-x-reverse">
                                            <input type="time" value="10:00"
                                                class="px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500 transition">
                                            <span class="text-gray-500">تا</span>
                                            <input type="time" value="22:00"
                                                class="px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500 transition">
                                        </div>
                                    </div>
                                </div>
                            </div>


                            <div class="flex justify-end space-x-3 space-x-reverse mt-8 pt-6 border-t border-gray-200">
                                <button type="button"
                                    class="px-6 py-3 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition">انصراف</button>
                                <button type="submit"
                                    class="px-6 py-3 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition">ذخیره
                                    تغییرات</button>
                            </div>
                        </form>
                    </section>

                    <!-- بخش مدیریت QR -->
                    <section id="manageqr" class="panel-section">
                        <div class="section-header">
                            <h2>مدیریت QR Code</h2>
                            <p>مدیریت و تولید QR Code برای منوهای کافه</p>
                        </div>

                        <div class="qr-management-container">
                            <div class="tab-actions">
                                <h3>QR Code های فعال</h3>
                                <div class="action-buttons">
                                    <button class="btn btn-primary" id="generate-qr-btn">
                                        <i class="fas fa-plus ml-2"></i>
                                        تولید QR جدید
                                    </button>
                                    <button class="btn btn-outline" id="refresh-qr-btn">
                                        <i class="fas fa-sync-alt ml-2"></i>
                                        بروزرسانی
                                    </button>
                                </div>
                            </div>

                            <!-- فیلترها -->
                            <div class="qr-filters">
                                <div class="filter-group">
                                    <label for="filter-menu">فیلتر بر اساس منو:</label>
                                    <select id="filter-menu" class="form-control">
                                        <option value="">همه منوها</option>
                                    </select>
                                </div>
                                <div class="filter-group">
                                    <label for="filter-active">فقط فعال‌ها:</label>
                                    <input type="checkbox" id="filter-active">
                                </div>
                                <div class="filter-group">
                                    <input type="text" id="qr-search" placeholder="جستجو در نام یا شماره میز..."
                                        class="form-control">
                                </div>
                            </div>

                            <!-- آمار -->
                            <div class="qr-stats">
                                <div class="stat-card">
                                    <div class="stat-icon">
                                        <i class="fas fa-qrcode"></i>
                                    </div>
                                    <div class="stat-info">
                                        <h3 id="total-qr-count">0</h3>
                                        <p>تعداد QR ها</p>
                                    </div>
                                </div>

                                <div class="stat-card">
                                    <div class="stat-icon">
                                        <i class="fas fa-eye"></i>
                                    </div>
                                    <div class="stat-info">
                                        <h3 id="total-scans">0</h3>
                                        <p>تعداد اسکن‌ها</p>
                                    </div>
                                </div>

                                <div class="stat-card">
                                    <div class="stat-icon">
                                        <i class="fas fa-chart-line"></i>
                                    </div>
                                    <div class="stat-info">
                                        <h3 id="active-qr-count">0</h3>
                                        <p>QRهای فعال</p>
                                    </div>
                                </div>
                            </div>

                            <!-- جدول QR Code ها -->
                            <div class="table-responsive">
                                <table class="table">
                                    <thead>
                                        <tr>
                                            <th>تصویر QR</th>
                                            <th>نام</th>
                                            <th>منو</th>
                                            <th>شماره میز</th>
                                            <th>تعداد اسکن</th>
                                            <th>وضعیت</th>
                                            <th>تاریخ ایجاد</th>
                                            <th>عملیات</th>
                                        </tr>
                                    </thead>
                                    <tbody id="qr-table-body">
                                        <!-- داده‌ها از API لود می‌شوند -->
                                    </tbody>
                                </table>
                            </div>

                            <!-- پیش‌نمایش QR -->
                            <div class="qr-preview-section" id="qr-preview-section" style="display: none;">
                                <h3>پیش‌نمایش QR Code</h3>
                                <div class="qr-preview">
                                    <div class="qr-code-placeholder">
                                        <img id="qr-preview-image" src="" alt="QR Code" style="display: none;">
                                        <div id="qr-loading" style="display: none;">
                                            <i class="fas fa-spinner fa-spin"></i>
                                            <p>در حال بارگذاری...</p>
                                        </div>
                                        <div id="qr-empty">
                                            <i class="fas fa-qrcode"></i>
                                            <p>QR Code در اینجا نمایش داده می‌شود</p>
                                        </div>
                                    </div>
                                    <div class="qr-info">
                                        <h4 id="qr-preview-name">-</h4>
                                        <p><strong>منو:</strong> <span id="qr-preview-menu">-</span></p>
                                        <p><strong>شماره میز:</strong> <span id="qr-preview-table">-</span></p>
                                        <p><strong>تعداد اسکن:</strong> <span id="qr-preview-scans">0</span></p>
                                        <p><strong>لینک:</strong> <span id="qr-preview-url">-</span></p>
                                        <div class="qr-actions">
                                            <button class="btn btn-primary" id="download-qr-btn">
                                                <i class="fas fa-download ml-2"></i>دانلود PNG
                                            </button>
                                            <button class="btn btn-outline" id="copy-link-btn">
                                                <i class="fas fa-copy ml-2"></i>کپی لینک
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </section>


                    <!-- بخش ساخت منو -->
                    <section id="menu-builder" class="panel-section">
                        <div class="section-header">
                            <h2>ساخت منوی اختصاصی</h2>
                            <p>منوی خود را با طراحی دلخواه ایجاد و شخصی‌سازی کنید</p>
                        </div>

                        <div class="menu-builder-container">
                            <!-- سایدبار ابزارها -->
                            <aside class="builder-tools">
                                <div class="tool-section">
                                    <h3>آیتم‌های منو</h3>
                                    <div class="menu-items-list">
                                        <div class="menu-item-draggable" draggable="true" data-type="category">
                                            <i class="fas fa-folder"></i> دسته‌بندی
                                        </div>
                                        <div class="menu-item-draggable" draggable="true" data-type="item">
                                            <i class="fas fa-utensils"></i> آیتم منو
                                        </div>
                                        <div class="menu-item-draggable" draggable="true" data-type="divider">
                                            <i class="fas fa-minus"></i> جداکننده
                                        </div>
                                    </div>
                                </div>

                                <div class="tool-section">
                                    <h3>تنظیمات ظاهری</h3>
                                    <div class="appearance-settings">
                                        <div class="form-group">
                                            <label>فونت متن</label>
                                            <select id="menu-font" class="form-control">
                                                <option value="IranSans, sans-serif">ایران سنس</option>
                                                <option value="Arial, sans-serif">Arial</option>
                                                <option value="Tahoma, sans-serif">Tahoma</option>
                                                <option value="'Segoe UI', sans-serif">Segoe UI</option>
                                            </select>
                                        </div>

                                        <div class="form-group">
                                            <label>رنگ زمینه</label>
                                            <input type="color" id="menu-bg-color" value="#ffffff">
                                        </div>

                                        <div class="form-group">
                                            <label>رنگ متن</label>
                                            <input type="color" id="menu-text-color" value="#333333">
                                        </div>

                                        <div class="form-group">
                                            <label>رنگ عنوان‌ها</label>
                                            <input type="color" id="menu-heading-color" value="#6F4E37">
                                        </div>

                                        <div class="form-group">
                                            <label>سبک منو</label>
                                            <select id="menu-style" class="form-control">
                                                <option value="classic">کلاسیک</option>
                                                <option value="modern">مدرن</option>
                                                <option value="minimal">مینیمال</option>
                                                <option value="elegant">الگانت</option>
                                            </select>
                                        </div>
                                    </div>
                                </div>

                                <div class="tool-section">
                                    <h3>تصویر زمینه</h3>
                                    <div class="background-upload">
                                        <input type="file" id="menu-bg-image" accept="image/*" style="display: none;">
                                        <label for="menu-bg-image" class="upload-btn">
                                            <i class="fas fa-cloud-upload-alt"></i> آپلود تصویر
                                        </label>
                                        <button id="remove-bg-btn" class="btn btn-outline btn-sm">حذف تصویر</button>
                                    </div>
                                </div>
                            </aside>

                            <!-- پیش‌نمایش منو -->
                            <main class="menu-preview">
                                <div class="preview-container">
                                    <div class="menu-header">
                                        <h2 contenteditable="true" class="editable">منوی کافه کتابخانه</h2>
                                        <p contenteditable="true" class="editable">فصل بهار ۱۴۰۲</p>
                                    </div>

                                    <div class="menu-body" id="droppable-area">
                                        <!-- نمونه منوی پیش‌فرض -->
                                        <div class="menu-category">
                                            <h3 contenteditable="true" class="editable">قهوه‌ها</h3>
                                            <div class="menu-items">
                                                <div class="menu-item">
                                                    <div class="item-details">
                                                        <h4 contenteditable="true" class="editable">اسپرسو</h4>
                                                        <p contenteditable="true" class="editable">قهوه اسپرسوی خالص با
                                                            عطر و طعم غلیظ</p>
                                                    </div>
                                                    <span class="item-price" contenteditable="true"
                                                        class="editable">45,000 تومان</span>
                                                </div>
                                                <div class="menu-item">
                                                    <div class="item-details">
                                                        <h4 contenteditable="true" class="editable">کاپوچینو</h4>
                                                        <p contenteditable="true" class="editable">ترکیب اسپرسو، شیر
                                                            بخار داده شده و فوم شیر</p>
                                                    </div>
                                                    <span class="item-price" contenteditable="true"
                                                        class="editable">55,000 تومان</span>
                                                </div>
                                            </div>
                                        </div>

                                        <div class="menu-divider"></div>

                                        <div class="menu-category">
                                            <h3 contenteditable="true" class="editable">دسرها</h3>
                                            <div class="menu-items">
                                                <div class="menu-item">
                                                    <div class="item-details">
                                                        <h4 contenteditable="true" class="editable">چیزکیک</h4>
                                                        <p contenteditable="true" class="editable">چیزکیک کلاسیک با توت
                                                            فرنگی تازه</p>
                                                    </div>
                                                    <span class="item-price" contenteditable="true"
                                                        class="editable">75,000 تومان</span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>

                                    <div class="menu-footer">
                                        <p contenteditable="true" class="editable">ساعات کاری: هر روز از ۸ صبح تا ۱۲ شب
                                        </p>
                                    </div>
                                </div>
                            </main>

                            <!-- پنل تنظیمات آیتم -->
                            <aside class="item-settings" id="item-settings-panel">
                                <div class="settings-header">
                                    <h3>تنظیمات آیتم</h3>
                                    <button class="close-settings">&times;</button>
                                </div>
                                <div class="settings-body">
                                    <div class="form-group">
                                        <label>نوع آیتم</label>
                                        <select id="item-type" class="form-control" disabled>
                                            <option value="category">دسته‌بندی</option>
                                            <option value="item">آیتم منو</option>
                                            <option value="divider">جداکننده</option>
                                        </select>
                                    </div>

                                    <div id="category-settings">
                                        <div class="form-group">
                                            <label>عنوان دسته‌بندی</label>
                                            <input type="text" id="category-title" class="form-control">
                                        </div>
                                    </div>

                                    <div id="item-settings" style="display: none;">
                                        <div class="form-group">
                                            <label>نام آیتم</label>
                                            <input type="text" id="item-name" class="form-control">
                                        </div>
                                        <div class="form-group">
                                            <label>توضیحات</label>
                                            <textarea id="item-description" class="form-control" rows="3"></textarea>
                                        </div>
                                        <div class="form-group">
                                            <label>قیمت (تومان)</label>
                                            <input type="text" id="item-price" class="form-control">
                                        </div>
                                        <div class="form-group">
                                            <label>تصویر آیتم (اختیاری)</label>
                                            <input type="file" id="item-image" accept="image/*" style="display: none;">
                                            <label for="item-image" class="upload-btn">
                                                <i class="fas fa-cloud-upload-alt"></i> آپلود تصویر
                                            </label>
                                        </div>
                                    </div>

                                    <div id="divider-settings" style="display: none;">
                                        <div class="form-group">
                                            <label>سبک جداکننده</label>
                                            <select id="divider-style" class="form-control">
                                                <option value="line">خط ساده</option>
                                                <option value="dotted">خط نقطه‌چین</option>
                                                <option value="dashed">خط خطی</option>
                                                <option value="pattern">الگو</option>
                                            </select>
                                        </div>
                                        <div class="form-group">
                                            <label>رنگ جداکننده</label>
                                            <input type="color" id="divider-color" value="#dddddd">
                                        </div>
                                    </div>

                                    <div class="form-group">
                                        <button id="delete-item" class="btn btn-danger">حذف آیتم</button>
                                    </div>
                                </div>
                            </aside>
                        </div>

                        <div class="builder-actions">
                            <button id="save-menu" class="btn btn-primary">
                                <i class="fas fa-save"></i> ذخیره منو
                            </button>
                            <button id="preview-menu" class="btn btn-outline">
                                <i class="fas fa-eye"></i> پیش‌نمایش کامل
                            </button>
                            <button id="reset-menu" class="btn btn-outline">
                                <i class="fas fa-redo"></i> بازنشانی
                            </button>
                        </div>

                        <!-- مودال پیش‌نمایش کامل -->
                        <div class="modal" id="full-preview-modal">
                            <div class="modal-content" style="max-width: 800px;">
                                <div class="modal-header">
                                    <h3>پیش‌نمایش کامل منو</h3>
                                    <button class="close-modal">&times;</button>
                                </div>
                                <div class="modal-body">
                                    <div id="full-menu-preview"></div>
                                </div>
                                <div class="modal-footer">
                                    <button class="btn btn-primary">
                                        <i class="fas fa-print"></i> چاپ منو
                                    </button>
                                    <button class="btn btn-outline close-modal">بستن</button>
                                </div>
                            </div>
                        </div>
                    </section>

                    <!-- بخش مدیریت منو -->
                    <section id="menu-management" class="panel-section active">
                        <div class="section-header">
                            <h2>مدیریت منو</h2>
                            <p>اینجا می‌توانید منوهای کافه‌رستوران خود را مدیریت کنید</p>
                        </div>

                        <!-- تب‌های مدیریت -->
                        <div class="tab-buttons">
                            <button id="categories-tab" class="tab-btn tab-active">
                                مدیریت دسته‌بندی‌ها
                            </button>
                            <button id="menu-items-tab" class="tab-btn">
                                مدیریت آیتم‌های منو
                            </button>
                            <button id="menus-tab" class="tab-btn">
                                مدیریت منوها
                            </button>
                        </div>

                        <!-- بخش مدیریت دسته‌بندی‌ها -->
                        <div id="categories-section" class="tab-content active">
                            <div class="tab-actions">
                                <h3>دسته‌بندی‌های منو</h3>
                                <button id="add-category-btn" class="btn btn-primary">
                                    <i class="fas fa-plus ml-2"></i>
                                    افزودن دسته‌بندی جدید
                                </button>
                            </div>

                            <div id="categorys" class="categorys-grid">
                                <!-- دسته‌بندی‌ها از API لود می‌شوند -->
                            </div>
                        </div>

                        <!-- بخش مدیریت آیتم‌های منو -->
                        <div id="menu-items-section" class="tab-content">
                            <div class="tab-actions">
                                <h3>آیتم‌های منو</h3>
                                <button id="add-item-btn" class="btn btn-primary">
                                    <i class="fas fa-plus ml-2"></i>
                                    افزودن آیتم جدید
                                </button>
                            </div>

                            <div class="table-responsive">
                                <table class="menu-items-table">
                                    <thead>
                                        <tr>
                                            <th>نام آیتم</th>
                                            <th>دسته‌بندی</th>
                                            <th>قیمت</th>
                                            <th>وضعیت</th>
                                            <th>عملیات</th>
                                        </tr>
                                    </thead>
                                    <tbody id="items">
                                        <!-- آیتم‌ها از API لود می‌شوند -->
                                    </tbody>
                                </table>
                            </div>
                        </div>

                        <!-- بخش مدیریت منوها -->
                        <div id="menus-section" class="tab-content">
                            <div class="tab-actions">
                                <h3>منوها</h3>
                                <button id="add-menu-btn" class="btn btn-primary">
                                    <i class="fas fa-plus ml-2"></i>
                                    ایجاد منوی جدید
                                </button>
                            </div>

                            <div id="menus" class="menus-grid">
                                <!-- منوها از API لود می‌شوند -->
                            </div>
                        </div>
                    </section>

                    <!-- بخش تحلیل فروش -->
                    <section id="sales-analysis" class="panel-section">
                        <div class="section-header">
                            <h2>تحلیل فروش</h2>
                            <p>آمار و گزارشات فروش کافه</p>
                        </div>

                        <div class="time-filters">
                            <div class="filter-buttons">
                                <button class="btn btn-outline active">امروز</button>
                                <button class="btn btn-outline">هفته جاری</button>
                                <button class="btn btn-outline">ماه جاری</button>
                                <button class="btn btn-outline">سال جاری</button>
                                <button class="btn btn-outline">سفارشی</button>
                            </div>
                            <div class="date-picker">
                                <input type="date" id="start-date">
                                <span>تا</span>
                                <input type="date" id="end-date">
                                <button class="btn btn-primary">اعمال</button>
                            </div>
                        </div>

                        <div class="sales-stats">
                            <div class="stat-card">
                                <h3>تعداد سفارشات</h3>
                                <p class="stat-value">124</p>
                                <p class="stat-change up">
                                    <i class="fas fa-arrow-up"></i>
                                    12% نسبت به دوره قبل
                                </p>
                            </div>

                            <div class="stat-card">
                                <h3>درآمد کل</h3>
                                <p class="stat-value">8,450,000 تومان</p>
                                <p class="stat-change up">
                                    <i class="fas fa-arrow-up"></i>
                                    18% نسبت به دوره قبل
                                </p>
                            </div>

                            <div class="stat-card">
                                <h3>میانگین سبد خرید</h3>
                                <p class="stat-value">68,145 تومان</p>
                                <p class="stat-change down">
                                    <i class="fas fa-arrow-down"></i>
                                    5% نسبت به دوره قبل
                                </p>
                            </div>
                        </div>

                        <div class="panel-row">
                            <div class="chart-container big-chart">
                                <h3>تغییرات فروش در یک ماه اخیر</h3>
                                <canvas id="salesChart"></canvas>
                            </div>
                        </div>

                        <div class="panel-row">
                            <div class="chart-container">
                                <h3>توزیع فروش بر اساس دسته‌بندی</h3>
                                <canvas id="salesByCategoryChart"></canvas>
                            </div>

                            <div class="chart-container">
                                <h3>ساعات اوج فروش</h3>
                                <canvas id="peakHoursChart"></canvas>
                            </div>
                        </div>

                        <div class="export-actions">
                            <button class="btn btn-outline">
                                <i class="fas fa-file-excel"></i>
                                خروجی Excel
                            </button>
                            <button class="btn btn-outline">
                                <i class="fas fa-file-pdf"></i>
                                خروجی PDF
                            </button>
                            <button class="btn btn-outline">
                                <i class="fas fa-print"></i>
                                چاپ گزارش
                            </button>
                        </div>
                    </section>

                    <!-- سایر بخش‌ها -->
                    <section id="reviews" class="panel-section">
                        <div class="section-header">
                            <h2>نظرات کاربران</h2>
                            <p>مدیریت و پاسخ به نظرات کاربران</p>
                        </div>
                        <p>این بخش به زودی اضافه خواهد شد.</p>
                    </section>

                    <section id="reservations" class="panel-section">
                        <div class="section-header">
                            <h2>رزروها</h2>
                            <p>مدیریت رزروهای کافه</p>
                        </div>
                        <p>این بخش به زودی اضافه خواهد شد.</p>
                    </section>

                    <section id="settings" class="panel-section">
                        <div class="section-header">
                            <h2>تنظیمات</h2>
                            <p>تنظیمات پیشرفته پنل مدیریت</p>
                        </div>
                        <p>این بخش به زودی اضافه خواهد شد.</p>
                    </section>
                </main>
            </div>
        </div>
    </div>

    <!-- مودال‌ها -->
    <div id="category-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="modal-title">افزودن دسته‌بندی جدید</h3>
                <button id="close-modal" class="text-gray-500 hover:text-dark transition"><i
                        class="fas fa-times"></i></button>
            </div>
            <div class="modal-body">
                <form id="category-form">
                    <div class="form-group">
                        <label for="category-name">نام دسته‌بندی</label>
                        <input type="text" id="category-name" placeholder="نام دسته‌بندی"
                            class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:border-primary-500 focus:ring-2 focus:ring-primary-500/20 transition">
                    </div>
                    <div class="form-group">
                        <label for="category-menu">منو مربوطه</label>
                        <select id="category-menu"
                            class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:border-primary-500 focus:ring-2 focus:ring-primary-500/20 transition">
                            <option value="">انتخاب منو</option>
                        </select>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" id="cancel-modal" class="btn btn-outline">انصراف</button>
                <button type="submit" form="category-form" class="btn btn-primary">ذخیره</button>
            </div>
        </div>
    </div>

    <div id="category-edit-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="modal-edit-title">ویرایش دسته‌بندی</h3>
                <button id="close-edit-modal" class="text-gray-500 hover:text-dark transition"><i
                        class="fas fa-times"></i></button>
            </div>
            <div class="modal-body">
                <form id="category-edit-form">
                    <div class="form-group">
                        <label for="category-edit-name">نام دسته‌بندی</label>
                        <input type="text" id="category-edit-name" placeholder="نام دسته‌بندی"
                            class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:border-primary-500 focus:ring-2 focus:ring-primary-500/20 transition">
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" id="cancel-edit-modal" class="btn btn-outline">انصراف</button>
                <button type="submit" form="category-edit-form" class="btn btn-primary">ذخیره</button>
            </div>
        </div>
    </div>

    <!-- مودال افزودن آیتم جدید -->
    <div id="item-modal" class="fixed inset-0 bg-black/50 flex items-center justify-center z-50 hidden">
        <div class="bg-white rounded-xl p-6 w-full max-w-3xl mx-4">
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-xl font-bold" id="item-modal-title">افزودن آیتم جدید</h3>
                <button id="close-item-modal" class="text-gray-500 hover:text-dark transition">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <form id="item-form">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <div class="mb-4">
                            <label for="add-item-name" class="block text-gray-700 mb-2">نام آیتم</label>
                            <input type="text" id="add-item-name"
                                class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:border-primary-500 focus:ring-2 focus:ring-primary-500/20 transition">
                        </div>
                        <div class="mb-4">
                            <label for="item-category" class="block text-gray-700 mb-2">دسته‌بندی</label>
                            <select id="item-category"
                                class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:border-primary-500 focus:ring-2 focus:ring-primary-500/20 transition">
                                <option value="">انتخاب دسته‌بندی</option>
                                <!-- دسته‌بندی‌ها اینجا لود می‌شوند -->
                            </select>
                        </div>
                        <div class="mb-4">
                            <label for="add-item-price" class="block text-gray-700 mb-2">قیمت</label>
                            <input type="text" id="add-item-price"
                                class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:border-primary-500 focus:ring-2 focus:ring-primary-500/20 transition">
                        </div>
                        <div class="mb-4">
                            <label for="item-desc" class=" block text-gray-700 mb-2">توضیحات</label>
                            <textarea id="item-desc" rows="2"
                                class="resize-none w-full px-4 py-2 border border-gray-300 rounded-lg focus:border-primary-500 focus:ring-2 focus:ring-primary-500/20 transition"></textarea>
                        </div>
                    </div>
                    <div>
                        <div class="mb-4">
                            <label for="add-item-image" class="block text-gray-700 mb-2">تصویر منو</label>
                            <input type="file" id="add-item-image" accept="image/*"
                                class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:border-primary-500 focus:ring-2 focus:ring-primary-500/20 transition">
                        </div>
                        <div class="mb-4">
                            <label class="block text-gray-700 mb-2">سایز</label>
                            <div class="flex gap-4">
                                <label class="flex items-center">
                                    <input type="checkbox" name="item-size" value="کوچک"
                                        class="rounded border-gray-300 text-primary-500 focus:ring-primary-500">
                                    <span class="mr-2">کوچک</span>
                                </label>
                                <label class="flex items-center">
                                    <input type="checkbox" name="item-size" value="متوسط"
                                        class="rounded border-gray-300 text-primary-500 focus:ring-primary-500">
                                    <span class="mr-2">متوسط</span>
                                </label>
                                <label class="flex items-center">
                                    <input type="checkbox" name="item-size" value="بزرگ"
                                        class="rounded border-gray-300 text-primary-500 focus:ring-primary-500">
                                    <span class="mr-2">بزرگ</span>
                                </label>
                            </div>
                        </div>
                        <div class="mb-8">
                            <label class="block text-gray-700 mb-2">اضافه‌ها</label>
                            <div class="flex gap-4">
                                <label class="flex items-center">

                                    <input id="extra-cheese" type="checkbox" name="item-extra" value="پنیر اضافی"
                                        class="rounded border-gray-300 text-primary-500 focus:ring-primary-500">
                                    <span class="mr-2">پنیر اضافی</span>
                                </label>
                                <label class="flex items-center">
                                    <input id="extra-sauce" type="checkbox" name="item-extra" value="سس اضافی"
                                        class="rounded border-gray-300 text-primary-500 focus:ring-primary-500">
                                    <span class="mr-2">سس اضافی</span>
                                </label>
                            </div>
                        </div>
                        <div class="mb-4">
                            <label class="flex items-center">

                                <input id="status" type="checkbox"
                                    class="rounded border-gray-300 text-primary-500 focus:ring-primary-500">
                                <span class="mr-2"> آیتم فعال باشد</span>
                            </label>
                        </div>
                    </div>
                </div>
                <div class="flex gap-3 mt-6 pt-4 border-t border-gray-200">
                    <button type="button" id="cancel-item-modal"
                        class="flex-1 px-4 py-3 border btn btn-outline text-gray-700 rounded-lg font-medium  transition">انصراف</button>
                    <button type="submit"
                        class="flex-1 px-4 py-3 btn btn-primary text-white rounded-lg font-medium  transition">ذخیره</button>
                </div>
            </form>
        </div>
    </div>

    <div id="item-edit-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="item-edit-modal-title">ویرایش آیتم</h3>
                <button id="close-edit-item-modal" class="text-gray-500 hover:text-dark transition"><i
                        class="fas fa-times"></i></button>
            </div>
            <div class="modal-body">
                <form id="item-edit-form">
                    <div class="form-group">
                        <label for="item-edit-name">نام آیتم</label>
                        <input type="text" id="item-edit-name" placeholder="نام آیتم"
                            class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:border-primary-500 focus:ring-2 focus:ring-primary-500/20 transition">
                    </div>
                    <div class="form-group">
                        <label for="item-edit-price">قیمت</label>
                        <input type="text" id="item-edit-price" placeholder="قیمت"
                            class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:border-primary-500 focus:ring-2 focus:ring-primary-500/20 transition">
                    </div>
                    <div class="form-group">
                        <div class="radio-container">
                            <input type="checkbox" id="item-edit-status" class="radio-input"
                                class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:border-primary-500 focus:ring-2 focus:ring-primary-500/20 transition">
                            <span>آیتم فعال باشد</span>
                        </div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" id="cancel-edit-item-modal" class="btn btn-outline">انصراف</button>
                <button type="submit" form="item-edit-form" class="btn btn-primary">ذخیره</button>
            </div>
        </div>
    </div>

    <div id="menu-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="menu-modal-title">ایجاد منوی جدید</h3>
                <button id="close-menu-modal" class="text-gray-500 hover:text-dark transition"><i
                        class="fas fa-times"></i></button>
            </div>
            <div class="modal-body">
                <form id="menu-form">
                    <div class="form-group">
                        <label for="menu-name">نام منو</label>
                        <input type="text" id="menu-name" placeholder="نام منو"
                            class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:border-primary-500 focus:ring-2 focus:ring-primary-500/20 transition">
                    </div>
                    <div class="form-group">
                        <label for="menu-image">تصویر منو</label>
                        <div class="image-upload">
                            <input type="file" id="menu-image" accept="image/*">
                            <label for="menu-image" class="upload-label">
                                <i class="fas fa-cloud-upload-alt"></i>
                                <span>آپلود تصویر</span>
                            </label>
                        </div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" id="cancel-menu-modal" class="btn btn-outline">انصراف</button>
                <button type="submit" form="menu-form" class="btn btn-primary">ذخیره</button>
            </div>
        </div>
    </div>

    <div id="menu-edit-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="menu-modal-edit-title">ویرایش منو</h3>
                <button id="close-menu-edit-modal" class="text-gray-500 hover:text-dark transition"><i
                        class="fas fa-times"></i></button>
            </div>
            <div class="modal-body">
                <form id="menu-edit-form">
                    <div class="form-group">
                        <label for="menu-edit-name">نام منو</label>
                        <input type="text" id="menu-edit-name" placeholder="نام منو"
                            class="w-full px-4 py-2 border border-gray-300 rounded-lg focus:border-primary-500 focus:ring-2 focus:ring-primary-500/20 transition">
                    </div>
                    <div class="form-group">
                        <label for="menu-edit-image">تصویر منو</label>
                        <div class="image-upload">
                            <input type="file" id="menu-edit-image" accept="image/*">
                            <label for="menu-edit-image" class="upload-label">
                                <i class="fas fa-cloud-upload-alt"></i>
                                <span>آپلود تصویر</span>
                            </label>
                        </div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" id="cancel-menu-edit-modal" class="btn btn-outline">انصراف</button>
                <button type="submit" form="menu-edit-form" class="btn btn-primary">ذخیره</button>
            </div>
        </div>
    </div>

    <script>
        // اسکریپت یکپارچه شده برای پنل مدیریت
        document.addEventListener('DOMContentLoaded', function () {
            // تغییر بین بخش‌های پنل
            const panelLinks = document.querySelectorAll('.panel-menu a');
            panelLinks.forEach(link => {
                link.addEventListener('click', function (e) {
                    e.preventDefault();

                    // حذف کلاس active از همه لینک‌ها
                    panelLinks.forEach(item => {
                        item.parentElement.classList.remove('active');
                    });

                    // اضافه کردن کلاس active به لینک فعلی
                    this.parentElement.classList.add('active');

                    // مخفی کردن همه بخش‌ها
                    const sections = document.querySelectorAll('.panel-section');
                    sections.forEach(section => {
                        section.classList.remove('active');
                    });

                    // نمایش بخش مربوطه
                    const targetId = this.getAttribute('href');
                    document.querySelector(targetId).classList.add('active');
                });
            });

            // تغییر بین تب‌های مدیریت منو
            const tabButtons = document.querySelectorAll('.tab-btn');
            const tabContents = document.querySelectorAll('.tab-content');

            tabButtons.forEach(button => {
                button.addEventListener('click', () => {
                    // حذف کلاس active از همه دکمه‌ها
                    tabButtons.forEach(btn => {
                        btn.classList.remove('tab-active');
                    });

                    // اضافه کردن کلاس active به دکمه کلیک شده
                    button.classList.add('tab-active');

                    // مخفی کردن همه محتواها
                    tabContents.forEach(content => {
                        content.classList.remove('active');
                    });

                    // نمایش محتوای مربوطه
                    const targetId = button.id.replace('-tab', '-section');
                    document.getElementById(targetId).classList.add('active');
                });
            });

            // مدیریت مودال‌ها
            const modals = document.querySelectorAll('.modal');
            const openModalButtons = document.querySelectorAll('[id$="-btn"]');
            const closeModalButtons = document.querySelectorAll('.close-modal, [id^="cancel-"]');

            // باز کردن مودال
            openModalButtons.forEach(button => {
                button.addEventListener('click', () => {
                    const modalId = button.id.replace('-btn', '-modal');
                    const modal = document.getElementById(modalId);
                    if (modal) {
                        modal.classList.add('active');
                    }
                });
            });

            // بستن مودال
            closeModalButtons.forEach(button => {
                button.addEventListener('click', () => {
                    modals.forEach(modal => {
                        modal.classList.remove('active');
                    });
                });
            });

            // بستن مودال با کلیک خارج از آن
            modals.forEach(modal => {
                modal.addEventListener('click', (e) => {
                    if (e.target === modal) {
                        modal.classList.remove('active');
                    }
                });
            });

            // مدیریت ارسال فرم‌ها
            const forms = document.querySelectorAll('form');
            forms.forEach(form => {
                form.addEventListener('submit', (e) => {
                    e.preventDefault();
                    // در اینجا کد ارسال فرم به سرور قرار می‌گیرد
                    alert('فرم با موفقیت ارسال شد!');

                    // بستن مودال پس از ارسال
                    modals.forEach(modal => {
                        modal.classList.remove('active');
                    });
                });
            });

            // تغییر وضعیت فیلترهای زمانی
            const timeFilters = document.querySelectorAll('.time-filters .btn');
            timeFilters.forEach(filter => {
                filter.addEventListener('click', function () {
                    timeFilters.forEach(item => {
                        item.classList.remove('active');
                    });
                    this.classList.add('active');
                });
            });

            // منوی موبایل
            const mobileMenuBtn = document.querySelector('.mobile-menu-btn');
            const navLinks = document.querySelector('.nav-links');
            const authButtons = document.querySelector('.auth-buttons');

            if (mobileMenuBtn) {
                mobileMenuBtn.addEventListener('click', function () {
                    navLinks.classList.toggle('active');
                    authButtons.classList.toggle('active');
                    mobileMenuBtn.classList.toggle('active');
                });
            }

            // تغییر هدر هنگام اسکرول
            window.addEventListener('scroll', function () {
                const header = document.querySelector('.header');
                if (window.scrollY > 100) {
                    header.classList.add('scrolled');
                } else {
                    header.classList.remove('scrolled');
                }
            });

            // انیمیشن اسکرول
            const animateOnScroll = function () {
                const elements = document.querySelectorAll('.category-card, .stat-card, .chart-container');

                elements.forEach(element => {
                    const elementPosition = element.getBoundingClientRect().top;
                    const screenPosition = window.innerHeight / 1.2;

                    if (elementPosition < screenPosition) {
                        element.classList.add('animated');
                    }
                });
            };

            window.addEventListener('scroll', animateOnScroll);
            animateOnScroll();

            // نمودارهای آماری
            if (document.getElementById('visitsChart')) {
                // نمودار بازدیدها
                const visitsCtx = document.getElementById('visitsChart').getContext('2d');
                new Chart(visitsCtx, {
                    type: 'line',
                    data: {
                        labels: ['شنبه', 'یکشنبه', 'دوشنبه', 'سه‌شنبه', 'چهارشنبه', 'پنجشنبه', 'جمعه'],
                        datasets: [{
                            label: 'تعداد بازدیدها',
                            data: [45, 60, 75, 50, 80, 110, 90],
                            backgroundColor: 'rgba(109, 40, 217, 0.1)',
                            borderColor: 'rgba(109, 40, 217, 1)',
                            borderWidth: 2,
                            tension: 0.4,
                            fill: true
                        }]
                    },
                    options: {
                        responsive: true,
                        plugins: {
                            legend: {
                                display: false
                            }
                        },
                        scales: {
                            y: {
                                beginAtZero: true
                            }
                        }
                    }
                });

                // نمودار آیتم‌های محبوب
                const popularItemsCtx = document.getElementById('popularItemsChart').getContext('2d');
                new Chart(popularItemsCtx, {
                    type: 'bar',
                    data: {
                        labels: ['اسپرسو', 'کاپوچینو', 'لاته', 'آمریکانو', 'موکا'],
                        datasets: [{
                            label: 'تعداد فروش',
                            data: [65, 59, 80, 45, 56],
                            backgroundColor: 'rgba(109, 40, 217, 0.7)',
                            borderColor: 'rgba(109, 40, 217, 1)',
                            borderWidth: 1
                        }]
                    },
                    options: {
                        responsive: true,
                        plugins: {
                            legend: {
                                display: false
                            }
                        },
                        scales: {
                            y: {
                                beginAtZero: true
                            }
                        }
                    }
                });

                // نمودار فروش
                const salesCtx = document.getElementById('salesChart').getContext('2d');
                new Chart(salesCtx, {
                    type: 'line',
                    data: {
                        labels: ['هفته 1', 'هفته 2', 'هفته 3', 'هفته 4'],
                        datasets: [{
                            label: 'فروش (میلیون تومان)',
                            data: [3.2, 4.5, 3.8, 5.1],
                            backgroundColor: 'rgba(109, 40, 217, 0.1)',
                            borderColor: 'rgba(109, 40, 217, 1)',
                            borderWidth: 2,
                            tension: 0.4,
                            fill: true
                        }]
                    },
                    options: {
                        responsive: true,
                        plugins: {
                            legend: {
                                display: false
                            }
                        },
                        scales: {
                            y: {
                                beginAtZero: true
                            }
                        }
                    }
                });

                // نمودار فروش بر اساس دسته‌بندی
                const salesByCategoryCtx = document.getElementById('salesByCategoryChart').getContext('2d');
                new Chart(salesByCategoryCtx, {
                    type: 'doughnut',
                    data: {
                        labels: ['قهوه‌ها', 'دسرها', 'نوشیدنی سرد', 'صبحانه'],
                        datasets: [{
                            data: [45, 25, 20, 10],
                            backgroundColor: [
                                'rgba(109, 40, 217, 0.8)',
                                'rgba(139, 92, 246, 0.8)',
                                'rgba(167, 139, 250, 0.8)',
                                'rgba(196, 181, 253, 0.8)'
                            ],
                            borderWidth: 0
                        }]
                    },
                    options: {
                        responsive: true,
                        plugins: {
                            legend: {
                                position: 'bottom'
                            }
                        }
                    }
                });

                // نمودار ساعات اوج فروش
                const peakHoursCtx = document.getElementById('peakHoursChart').getContext('2d');
                new Chart(peakHoursCtx, {
                    type: 'bar',
                    data: {
                        labels: ['8-10', '10-12', '12-14', '14-16', '16-18', '18-20', '20-22'],
                        datasets: [{
                            label: 'تعداد سفارشات',
                            data: [15, 35, 60, 40, 55, 70, 45],
                            backgroundColor: 'rgba(109, 40, 217, 0.7)',
                            borderColor: 'rgba(109, 40, 217, 1)',
                            borderWidth: 1
                        }]
                    },
                    options: {
                        responsive: true,
                        plugins: {
                            legend: {
                                display: false
                            }
                        },
                        scales: {
                            y: {
                                beginAtZero: true
                            }
                        }
                    }
                });
            }


            // ============    بخش ویرایش اطلاعات  =============


            const token = sessionStorage.getItem("accessToken"); // اگه JWT داری از لاگین

            const API_URL = "http://135.125.238.202:7050/user/profile/";

            // برای ساختن کتگوری و فیچر که بعدا باید توی پنل ادمین باشند

            const btnCategoryTest = document.getElementById("send-category-test");
            const btnFeatureTest = document.getElementById("send-feature-test");



            btnCategoryTest.addEventListener("click", async function () {

                const title = document.getElementById("category-test").value;

                const payload = {
                    title

                };
                console.log(payload)

                const res = await fetch("http://135.125.238.202:7050/user/category/", {
                    method: "POST",
                    headers: {
                        "Authorization": `Bearer ${token}`
                        , "Content-Type": "application/json"
                    },
                    body: JSON.stringify(payload)
                })

                const data = await res.json();

                if (!res.ok) {
                    console.log("test category server not response :", data);
                }
                else {
                    console.log("test category server response ok", data)
                }

            })

            btnFeatureTest.addEventListener("click", async function () {

                const title = document.getElementById("feature-test").value;

                const payload = {
                    title

                };
                console.log(payload)

                const res = await fetch("http://135.125.238.202:7050/user/feature/", {
                    method: "POST",
                    headers: {
                        "Authorization": `Bearer ${token}`
                        , "Content-Type": "application/json"
                    },
                    body: JSON.stringify(payload)
                })

                const data = await res.json();

                if (!res.ok) {
                    console.log("test category server not response :", data);
                }
                else {
                    console.log("test category server response ok", data)
                }

            })


            // انتخاب المنت‌ها
            const nameInput = document.getElementById("cafe-name");
            const categorySelect = document.getElementById("cafe-category");
            const addressInput = document.getElementById("cafe-address");
            const descriptionInput = document.getElementById("cafe-description");
            const featureSelect = document.getElementById("cafe-fetures"); // دقت کن با id هم‌خوانی داشته باشه
            const timeInputs = document.querySelectorAll("input[type='time']");

            const API_PROFILE = "http://135.125.238.202:7050/user/profile/";
            const API_CATEGORY = "http://135.125.238.202:7050/user/category/";
            const API_FEATURE = "http://135.125.238.202:7050/user/feature/";

            async function loadUserData() {
                try {
                    const [profileRes, categoryRes, featureRes] = await Promise.all([
                        fetch(API_PROFILE, { headers: { "Authorization": `Bearer ${token}` } }),
                        fetch(API_CATEGORY, { headers: { "Authorization": `Bearer ${token}` } }),
                        fetch(API_FEATURE, { headers: { "Authorization": `Bearer ${token}` } }),
                    ]);

                    const [profileData, categoryData, featureData] = await Promise.all([
                        profileRes.json(),
                        categoryRes.json(),
                        featureRes.json(),
                    ]);

                    console.log("📘 Profile:", profileData);
                    console.log("📗 Categories:", categoryData);
                    console.log("📙 Features:", featureData);

                    // ---- پر کردن اطلاعات اصلی ----
                    nameInput.value = profileData.name || "";
                    addressInput.value = profileData.address || "";
                    descriptionInput.value = profileData.description || "";

                    // ---- پر کردن دسته‌بندی‌ها ----
                    categorySelect.innerHTML = `<option value="0">انتخاب کنید</option>`;
                    function buildCategoryOptions(list, prefix = "") {
                        if (!Array.isArray(list)) return;
                        list.forEach(cat => {
                            const opt = document.createElement("option");
                            opt.value = cat.id;
                            opt.textContent = prefix + cat.title;
                            categorySelect.appendChild(opt);
                            if (Array.isArray(cat.children) && cat.children.length > 0) {
                                buildCategoryOptions(cat.children, prefix + "— ");
                            }
                        });
                    }
                    const categoryList = Array.isArray(categoryData[0]) ? categoryData[0] : categoryData;
                    buildCategoryOptions(categoryList);

                    if (Array.isArray(profileData.category) && profileData.category.length > 0) {
                        categorySelect.value = profileData.category[0];
                    }

                    // ---- پر کردن فیچرها ----
                    featureSelect.innerHTML = `<option value="0">انتخاب کنید</option>`;
                    if (Array.isArray(featureData)) {
                        featureData.forEach(feat => {
                            const opt = document.createElement("option");
                            opt.value = feat.id;
                            opt.textContent = feat.title;
                            featureSelect.appendChild(opt);
                        });
                    }

                    if (Array.isArray(profileData.features) && profileData.features.length > 0) {
                        featureSelect.value = profileData.features[0];
                    }

                    // ---- ساعات کاری ----
                    if (profileData.work_hours) {
                        const days = Object.keys(profileData.work_hours);
                        days.forEach((day, i) => {
                            const [start, end] = profileData.work_hours[day].split("-");
                            if (timeInputs[i * 2]) timeInputs[i * 2].value = start.padStart(5, "0");
                            if (timeInputs[i * 2 + 1]) timeInputs[i * 2 + 1].value = end.padStart(5, "0");
                        });
                    }

                } catch (err) {
                    console.error("❌ خطا در دریافت اطلاعات:", err);
                }

                // 🗺️ مقدار اولیه نقشه (مرکز روی تهران)
                const map = L.map('map').setView([35.6892, 51.3890], 13);

                // لایه نقشه از OpenStreetMap
                L.tileLayer('https://tile.openstreetmap.org/{z}/{x}/{y}.png', {
                    attribution: '&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors'
                }).addTo(map);

                // مارکر اولیه
                let marker = L.marker([35.6892, 51.3890], { draggable: true }).addTo(map);

                // مقدار پیش‌فرض مخفی
                document.getElementById("lat").value = 35.6892;
                document.getElementById("long").value = 51.3890;

                // وقتی روی نقشه کلیک می‌کند
                map.on('click', function (e) {
                    const { lat, lng } = e.latlng;
                    marker.setLatLng(e.latlng);
                    document.getElementById("lat").value = lat.toFixed(6);
                    document.getElementById("long").value = lng.toFixed(6);
                });

                // وقتی مارکر جابه‌جا می‌شود
                marker.on('moveend', function (e) {
                    const { lat, lng } = e.target.getLatLng();
                    document.getElementById("lat").value = lat.toFixed(6);
                    document.getElementById("long").value = lng.toFixed(6);
                });

                // اگر در پروفایل lat/long ذخیره شده، آن را در نقشه نشان بده
                async function setMapFromProfile() {
                    try {
                        const res = await fetch(API_PROFILE, { headers: { "Authorization": `Bearer ${token}` } });
                        const data = await res.json();
                        if (data.lat && data.long) {
                            marker.setLatLng([data.lat, data.long]);
                            map.setView([data.lat, data.long], 14);
                            document.getElementById("lat").value = data.lat;
                            document.getElementById("long").value = data.long;
                        }
                    } catch (e) {
                        console.warn("⚠️ خطا در بارگذاری مختصات:", e);
                    }
                }

                setMapFromProfile();


            }




            // ✅ ارسال تغییرات (POST)
            const form = document.getElementById("edit-user");

            form.addEventListener("submit", async (e) => {
                e.preventDefault();

                // ورودی‌ها
                const address = document.getElementById("cafe-address").value.trim();
                const description = document.getElementById("cafe-description").value.trim();
                const category = [document.getElementById("cafe-category").value];
                const features = [document.getElementById("cafe-fetures").value];
                const timeInputs = document.querySelectorAll("input[type='time']");



                // ساعات کاری (هر روز جداگانه)
                const work_hours = {
                    "شنبه": `${timeInputs[0].value}-${timeInputs[1].value}`,
                    "یکشنبه": `${timeInputs[2].value}-${timeInputs[3].value}`,
                    "دوشنبه": `${timeInputs[4].value}-${timeInputs[5].value}`,
                    "سه‌شنبه": `${timeInputs[6].value}-${timeInputs[7].value}`,
                    "چهارشنبه": `${timeInputs[8].value}-${timeInputs[9].value}`,
                    "پنجشنبه": `${timeInputs[10].value}-${timeInputs[11].value}`,
                    "جمعه": `${timeInputs[12].value}-${timeInputs[13].value}`,
                };

                const lat = parseFloat(document.getElementById("lat").value);
                const long = parseFloat(document.getElementById("long").value);




                // بدنه درخواست
                const payload = {
                    address,
                    lat,
                    long,
                    description,
                    work_hours,
                    features,
                    category,
                };

                console.log("📦 Payload نهایی:", payload);

                try {
                    const res = await fetch(API_URL, {
                        method: "POST",
                        headers: {
                            "Authorization": `Bearer ${token}`,
                            "Content-Type": "application/json",
                        },
                        body: JSON.stringify(payload),
                    });

                    const data = await res.json();

                    if (!res.ok) {
                        console.error("❌ خطا:", data);
                        alert("درخواست نامعتبر است (400)");
                        return;
                    }

                    alert("✅ اطلاعات با موفقیت ثبت شد!");
                    console.log("✅ پاسخ سرور:", data);

                } catch (err) {
                    console.error("🚫 خطای شبکه:", err);
                    alert("مشکلی در ارسال اطلاعات به سرور پیش آمد!");
                }
            });

            // اجرای اولیه برای دریافت داده‌ها
            loadUserData();




            // ============ API و منطق مدیریت منو از کد دوم ============

            // const token = sessionStorage.getItem('accessToken');

            if (!token) {
                window.location.href = "login.html";
                return;
            }

            // توابع API - دقیقاً از کد شما گرفته شده
            async function loadMenusForDropdown() {
                try {
                    const response = await fetch("http://135.125.238.202:7050/menu/", {
                        method: "GET",
                        headers: { 'Authorization': `Bearer ${token}` }
                    });
                    const menusList = await response.json();

                    const categoryMenuSelect = document.getElementById('category-menu');
                    categoryMenuSelect.innerHTML = '<option value="">انتخاب منو</option>';

                    menusList.forEach(menu => {
                        const option = document.createElement('option');
                        option.value = menu.id;
                        option.textContent = menu.name;
                        categoryMenuSelect.appendChild(option);
                    });
                } catch (error) {
                    console.error('خطا در دریافت منوها برای دراپ‌داون:', error);
                }
            }

            async function loadCategoriesForDropdown() {
                try {
                    const response = await fetch("http://135.125.238.202:7050/menu/category/", {
                        headers: {
                            'Authorization': `Bearer ${token}`
                        }
                    });

                    if (!response.ok) {
                        throw new Error(`خطا در دریافت دسته‌بندی‌ها: ${response.status}`);
                    }

                    const categories = await response.json();
                    const categorySelect = document.getElementById('item-category');
                    categorySelect.innerHTML = '<option value="">انتخاب دسته‌بندی</option>';

                    categories.forEach(category => {
                        const option = document.createElement('option');
                        option.value = category.id; // یا category.name بسته به انتظار سرور
                        option.textContent = category.name;
                        categorySelect.appendChild(option);
                    });
                } catch (error) {
                    console.error('خطا در بارگذاری دسته‌بندی‌ها:', error);
                    alert('مشکلی در بارگذاری دسته‌بندی‌ها پیش آمد');
                }
            }

            //نمایش منو ها
            const menus = document.getElementById("menus");
            let currentMenuId = null;
            async function loadMenus() {
                try {
                    const response = await fetch("http://135.125.238.202:7050/menu/", {
                        method: "GET",
                        headers: { 'Authorization': `Bearer ${token}` }
                    });
                    const menusList = await response.json();

                    menus.innerHTML = "";
                    console.log(menusList);
                    menusList.forEach(menu => {
                        const card = document.createElement("div");
                        card.className = "menu-card";

                        // مسیر کامل عکس
                        const baseUrl = "http://135.125.238.202:7050";
                        const imageUrl = menu.image_path ? `${baseUrl}${menu.image_path}` : null;

                        card.innerHTML = `
                            <div class="menu-header">
                                <div class="w-16 h-16 rounded-lg overflow-hidden bg-gray-100 flex items-center justify-center mr-2">
                                    ${imageUrl
                                ? `<img src="${imageUrl}" alt="${menu.name}" class="w-full h-full object-cover">`
                                : `<i class="fas fa-utensils text-3xl text-gray-300"></i>`}
                                </div>
                                <div class="flex flex-col justify-center items-start flex-1 mr-2 pr-5">
                                    <h4 class="text-xl font-bold mb-1">${menu.name}</h4>
                                    <span class="text-gray-500 text-sm">menu id = ${menu.id}</span>
                                </div>
                                <div class="menu-actions">
                                    <button class="edit-menu-btn" data-id="${menu.id}">
                                        <i class="fas fa-edit"></i>
                                    </button>
                                    <button class="delete-menu-btn" data-id="${menu.id}">
                                        <i class="fas fa-trash"></i>
                                    </button>
                                </div>
                            </div>
                            
                            <div class="menu-actions-buttons">
                                <button class="view-menu-btn" onclick="window.location.href='menu.html?id=${menu.id}'">
                                 مشاهده منو اول
                                </button>
                                <button class="view-menu-btn" onclick="window.location.href='menu2.html?id=${menu.id}'">
                                 مشاهده منو دوم
                                </button>
                                <button class="view-menu-btn" onclick="window.location.href='menu3.html?id=${menu.id}'">
                                 مشاهده منو سوم
                                </button>
                            </div>
                        `;
                        menus.appendChild(card);
                    });

                    // فقط دکمه‌های حذف منو را فعال کن
                    document.querySelectorAll('.delete-menu-btn').forEach(btn => {
                        btn.addEventListener('click', async function () {
                            const menuId = btn.getAttribute('data-id');

                            if (confirm('آیا از حذف این منو اطمینان دارید؟')) {
                                try {
                                    const response = await fetch(`http://135.125.238.202:7050/menu/${menuId}/`, {
                                        method: "DELETE",
                                        headers: {
                                            "Authorization": `Bearer ${token}`
                                        }
                                    });
                                    if (response.ok) {
                                        alert("منو با موفقیت حذف شد!");
                                        loadMenus();
                                    } else {
                                        alert("خطا در حذف منو");
                                    }
                                } catch (error) {
                                    alert("ارتباط با سرور برقرار نشد");
                                }
                            }
                        });
                    });

                    document.querySelectorAll('.edit-menu-btn').forEach(btn => {
                        const menuModal = document.getElementById('menu-edit-modal');
                        const closeMenuModalBtn = document.getElementById('close-menu-edit-modal');
                        const cancelMenuModalBtn = document.getElementById('cancel-menu-edit-modal');

                        const modalTitle = document.getElementById('menu-modal-edit-title');

                        btn.addEventListener('click', () => {
                            currentMenuId = btn.getAttribute('data-id');
                            modalTitle.textContent = `ویرایش منو`;
                            menuModal.classList.add('active');
                        });

                        closeMenuModalBtn.addEventListener('click', () => {
                            menuModal.classList.remove('active');
                        });

                        cancelMenuModalBtn.addEventListener('click', () => {
                            menuModal.classList.remove('active');
                        });
                    });

                } catch (error) {
                    console.error(error);
                    menus.innerHTML = '<div class="text-danger text-center">خطا در دریافت منوها</div>';
                }
            }

            const menuEditForm = document.getElementById('menu-edit-form');
            menuEditForm.addEventListener('submit', async (e) => {
                const menuModal = document.getElementById('menu-edit-modal');
                e.preventDefault();

                const name = document.getElementById('menu-edit-name');
                const image = document.getElementById('menu-edit-image');

                const formData = new FormData();
                formData.append("name", name.value);
                if (image.files[0]) {
                    formData.append("image", image.files[0]);
                }

                try {
                    const response = await fetch(`http://135.125.238.202:7050/menu/${currentMenuId}/`, {
                        method: "PUT",
                        headers: {
                            'Authorization': `Bearer ${token}`
                        },
                        body: formData
                    });

                    const data = await response.json();
                    if (response.status === 200) {
                        alert('منو با موفقیت ذخیره شد ');
                        menuModal.classList.remove('active');
                        loadMenus();
                    } else {
                        alert(' خطا در ارتباط با سرور');
                    }
                } catch (error) {
                    console.error(" ارور شما : ", error);
                }
            });

            // مدیریت مودال دسته‌بندی
            const categoryModal = document.getElementById('category-modal');
            const addCategoryBtn = document.getElementById('add-category-btn');
            const closeModalBtn = document.getElementById('close-modal');
            const cancelModalBtn = document.getElementById('cancel-modal');
            const categoryForm = document.getElementById('category-form');

            addCategoryBtn.addEventListener('click', () => {
                document.getElementById('modal-title').textContent = 'افزودن دسته‌بندی جدید';
                loadMenusForDropdown();
                categoryModal.classList.add('active');
            });

            closeModalBtn.addEventListener('click', () => {
                categoryModal.classList.remove('active');
            });

            cancelModalBtn.addEventListener('click', () => {
                categoryModal.classList.remove('active');
            });

            categoryForm.addEventListener('submit', async (e) => {
                e.preventDefault();

                const menu = document.getElementById('category-menu').value;
                const name = document.getElementById('category-name').value;
                if (!menu) {
                    alert('لطفاً یک منو انتخاب کنید');
                    return;
                }

                try {
                    const response = await fetch("http://135.125.238.202:7050/menu/category/", {
                        method: "POST",
                        headers: {
                            'Content-Type': 'application/json',
                            'Authorization': `Bearer ${token}`
                        },
                        body: JSON.stringify({
                            menu, name
                        })
                    })

                    const data = await response.json();
                    if (response.status === 201) {
                        alert('دسته بندی با موفقیت ذخیره شد ');
                        categoryModal.classList.remove('active');
                        loadCategory();
                    }
                    else {
                        alert(' خطا در ارتباط ');
                    }
                } catch (error) {
                    console.error(" ارور شما : ", error);
                }
                categoryModal.classList.remove('active');
            });

            // نمایش دسته بندی ها
            const categorys = document.getElementById("categorys");
            let currentCategoryId = null;

            async function loadCategory() {
                try {
                    const response = await fetch("http://135.125.238.202:7050/menu/category/", {
                        method: "GET",
                        headers: {
                            'Authorization': `Bearer ${token}`
                        }
                    })
                    const categoyList = await response.json();

                    categorys.innerHTML = "";
                    console.log(categoyList);
                    categoyList.forEach(category => {
                        const card = document.createElement("div");
                        card.className = "category-card";

                        card.innerHTML = `
                            <div class="category-header">
                                <div class="category-icon">
                                    <i class="fas fa-folder"></i>
                                </div>
                                <div class="category-actions">
                                    <button class="edit-category-btn" category-id="${category.id}">
                                        <i class="fas fa-edit"></i>
                                    </button>
                                    <button class="delete-category-btn" category-id="${category.id}">
                                        <i class="fas fa-trash"></i>
                                    </button>
                                </div>
                            </div>
                            <h4>${category.name}</h4>
                            <p>دسته‌بندی منو</p>
                            <div class="category-footer">
                                <span>category id = ${category.id}</span>
                                <span class="status-badge active">فعال</span>
                            </div>
                        `;
                        categorys.appendChild(card);
                    });

                    document.querySelectorAll('.delete-category-btn').forEach(btn => {
                        btn.addEventListener('click', async function () {
                            const categoryId = btn.getAttribute('category-id');

                            if (confirm('آیا از حذف این دسته بندی اطمینان دارید؟')) {
                                try {
                                    const response = await fetch(`http://135.125.238.202:7050/menu/category/${categoryId}/`, {
                                        method: "DELETE",
                                        headers: {
                                            "Authorization": `Bearer ${token}`
                                        }
                                    });
                                    if (response.ok) {
                                        alert("دسته بندی با موفقیت حذف شد!");
                                        loadCategory();
                                    } else {
                                        alert("خطا در حذف دسته بندی");
                                    }
                                } catch (error) {
                                    alert("ارتباط با سرور برقرار نشد");
                                }
                            }
                        });
                    });

                    document.querySelectorAll('.edit-category-btn').forEach(btn => {
                        const categoryModal = document.getElementById('category-edit-modal');
                        const closeModalBtn = document.getElementById('close-edit-modal');
                        const cancelModalBtn = document.getElementById('cancel-edit-modal');

                        btn.addEventListener('click', () => {
                            currentCategoryId = btn.getAttribute('category-id');
                            document.getElementById('modal-edit-title').textContent = 'ویرایش دسته‌بندی';
                            categoryModal.classList.add('active');
                        });

                        closeModalBtn.addEventListener('click', () => {
                            categoryModal.classList.remove('active');
                        });

                        cancelModalBtn.addEventListener('click', () => {
                            categoryModal.classList.remove('active');
                        });
                    });

                } catch (error) {
                    console.error(error);
                    categorys.innerHTML = '<div class="text-danger text-center">خطا در دریافت دسته بندی ها</div>';
                }
            }

            const categoryEditForm = document.getElementById('category-edit-form');
            categoryEditForm.addEventListener('submit', async (e) => {
                const categoryModal = document.getElementById('category-edit-modal');
                e.preventDefault();

                const name = document.getElementById('category-edit-name').value;
                try {
                    const response = await fetch(`http://135.125.238.202:7050/menu/category/${currentCategoryId}/`, {
                        method: "PUT",
                        headers: {
                            'Content-Type': 'application/json',
                            'Authorization': `Bearer ${token}`
                        },
                        body: JSON.stringify({
                            name
                        })
                    })

                    const data = await response.json();
                    if (response.status === 200) {
                        alert('دسته بندی با موفقیت ذخیره شد ');
                        categoryModal.classList.remove('active');
                        loadCategory();
                    }
                    else {
                        alert(' خطا در ارتباط ');
                    }
                } catch (error) {
                    console.error(" ارور شما : ", error);
                }
            });

            const inputPrice = document.getElementById("add-item-price");

            inputPrice.addEventListener("input", function () {
                // همه‌ی کاراکترهای غیررقمی حذف میشن
                let value = this.value.replace(/\D/g, "");

                // جداکردن ۳ رقمی
                if (value) {
                    this.value = value.replace(/\B(?=(\d{3})+(?!\d))/g, ",");
                } else {
                    this.value = "";
                }
            });

            // مودال آیتم جدید
            const itemModal = document.getElementById('item-modal');
            const addItemBtn = document.getElementById('add-item-btn');
            const closeItemModalBtn = document.getElementById('close-item-modal');
            const cancelItemModalBtn = document.getElementById('cancel-item-modal');
            const itemForm = document.getElementById('item-form');

            addItemBtn.addEventListener('click', () => {
                document.getElementById('item-modal-title').textContent = 'افزودن آیتم جدید';
                loadCategoriesForDropdown();
                itemModal.classList.remove('hidden');
            });

            closeItemModalBtn.addEventListener('click', () => {
                itemModal.classList.add('hidden');
            });

            cancelItemModalBtn.addEventListener('click', () => {
                itemModal.classList.add('hidden');
            });

            itemForm.addEventListener('submit', async (e) => {
                e.preventDefault();

                const itemName = document.getElementById("add-item-name").value;
                const itemCategory = document.getElementById("item-category").value;
                const itemPrice = (document.getElementById("add-item-price"));
                const itemDesc = document.getElementById("item-desc").value.trim();
                const itemImage = document.getElementById("add-item-image");
                const status = document.getElementById("status").checked;



                if (!itemCategory) {
                    alert('لطفاً یک دسته‌بندی انتخاب کنید');
                    return;
                }

                const rawValue = itemPrice.value.replace(/,/g, "");

                // گرفتن سایزها و extras
                const sizeCheckboxes = document.querySelectorAll('input[name="item-size"]:checked');
                const sizes = Array.from(sizeCheckboxes).map(cb => cb.value);

                const extraCheckboxes = document.querySelectorAll('input[name="item-extra"]:checked');
                const extras = Array.from(extraCheckboxes).map(cb => cb.value);

                const formData = new FormData();
                formData.append("name", itemName);

                // فقط اگر فایل انتخاب شده
                if (itemImage.files[0]) {
                    formData.append("image", itemImage.files[0]);
                }

                formData.append("category", itemCategory);
                formData.append("price", rawValue.toString());
                formData.append("description", itemDesc);
                formData.append("is_available", status.toString());

                // options باید به درستی فرمت شود
                const options = {
                    size: sizes,
                    extra: extras
                };
                formData.append("options", JSON.stringify(options));

                // لاگ برای دیباگ
                console.log("داده‌های ارسالی:");
                for (let [key, value] of formData.entries()) {
                    console.log(key + ": " + value);
                }

                try {
                    const response = await fetch("http://135.125.238.202:7050/menu/item/", {
                        method: "POST",
                        headers: {
                            'Authorization': `Bearer ${token}`
                            // توجه: برای FormData، Content-Type نباید ست شود
                        },
                        body: formData
                    });

                    if (!response.ok) {
                        const errorText = await response.text();
                        console.error("پاسخ خطا از سرور:", errorText);
                        throw new Error(`خطا در ارسال: ${response.status} - ${errorText}`);
                    }

                    const data = await response.json();
                    console.log("پاسخ موفق از سرور:", data);
                    alert("آیتم با موفقیت ذخیره شد!");
                    itemModal.classList.add("hidden");
                    itemForm.reset(); // ریست فرم
                    loadItem(); // بارگذاری مجدد آیتم‌ها

                } catch (error) {
                    console.error("خطا:", error);
                    alert("مشکلی در ذخیره آیتم پیش آمد: " + error.message);
                }
            });


            //نمایش آیتم ها
            const items = document.getElementById("items");
            let currentItemId = null;

            async function loadItem() {
                try {
                    const response = await fetch("http://135.125.238.202:7050/menu/item/", {
                        method: "GET",
                        headers: {
                            'Authorization': `Bearer ${token}`
                        }
                    })

                    const itemList = await response.json();
                    console.log(itemList);
                    items.innerHTML = "";

                    itemList.forEach(item => {
                        const card = document.createElement("tr");
                        // مسیر کامل عکس
                        const baseUrl = "http://135.125.238.202:7050";
                        const imageUrl = item.image_path ? `${baseUrl}${item.image_path}` : null;
                        const formattedPrice = parseInt(item.price).toLocaleString('fa-IR') + ' تومان';

                        card.innerHTML = `
                            <td>
                                <div class="item-cell">
                                    <img src="${imageUrl}" alt="اسپرسو" class="w-10 h-10 rounded-lg object-cover mr-3">
                                    <div class="item-info">
                                        <h4>${item.name}</h4>
                                        <p>${item.description}</p>
                                    </div>
                                </div>
                            </td>
                            <td>دسته‌بندی ${item.category}</td>
                            <td class="item-price">${formattedPrice}</td>
                            <td>
                                <span class="item-status ${item.is_available ? 'active' : 'inactive'}">
                                    ${item.is_available ? 'موجود' : 'ناموجود'}
                                </span>
                            </td>
                            <td>
                                <div class="table-actions">
                                    <button class="edit-item-btn" item-id="${item.id}">
                                        <i class="fas fa-edit"></i>
                                    </button>
                                    <button class="delete-item-btn" item-id="${item.id}">
                                        <i class="fas fa-trash"></i>
                                    </button>
                                </div>
                            </td>
                        `;
                        items.appendChild(card);
                    });

                    document.querySelectorAll('.delete-item-btn').forEach(btn => {
                        btn.addEventListener('click', async function () {
                            const itemId = btn.getAttribute('item-id');
                            console.log(itemId);
                            if (confirm('آیا از حذف این آیتم اطمینان دارید؟')) {
                                try {
                                    const response = await fetch(`http://135.125.238.202:7050/menu/item/${itemId}/`, {
                                        method: "DELETE",
                                        headers: {
                                            "Authorization": `Bearer ${token}`
                                        }
                                    });
                                    if (response.ok) {
                                        alert("آیتم با موفقیت حذف شد");
                                        loadItem();
                                    } else {
                                        alert("خطا در حذف آتیم");
                                    }
                                } catch (error) {
                                    alert("ارتباط با سرور برقرار نشد");
                                }
                            }
                        });
                    });

                    document.querySelectorAll('.edit-item-btn').forEach(btn => {
                        const itemModal = document.getElementById('item-edit-modal');
                        const closeItemModalBtn = document.getElementById('close-edit-item-modal');
                        const cancelItemModalBtn = document.getElementById('cancel-edit-item-modal');

                        btn.addEventListener('click', () => {
                            currentItemId = btn.getAttribute('item-id');
                            document.getElementById('item-edit-modal-title').textContent = 'ویرایش آیتم';
                            itemModal.classList.add('active');
                        });

                        closeItemModalBtn.addEventListener('click', () => {
                            itemModal.classList.remove('active');
                        });

                        cancelItemModalBtn.addEventListener('click', () => {
                            itemModal.classList.remove('active');
                        });
                    });

                } catch (error) {
                    console.error("خطا در دریافت آیتم‌ها:", error);
                }
            }

            const itemEditForm = document.getElementById('item-edit-form');

            const inputEditPrice = document.getElementById("item-edit-price");

            inputEditPrice.addEventListener("input", function () {
                // همه‌ی کاراکترهای غیررقمی حذف میشن
                let value = this.value.replace(/\D/g, "");

                // جداکردن ۳ رقمی
                if (value) {
                    this.value = value.replace(/\B(?=(\d{3})+(?!\d))/g, ",");
                } else {
                    this.value = "";
                }
            });

            itemEditForm.addEventListener('submit', async (e) => {
                e.preventDefault();
                const itemModal = document.getElementById('item-edit-modal');

                const itemName = document.getElementById("item-edit-name").value;
                const itemPrice = (document.getElementById("item-edit-price"));
                const status = document.getElementById("item-edit-status").checked;

                const rawValue = itemPrice.value.replace(/,/g, "");

                const formData = new FormData();
                formData.append("name", itemName);
                formData.append("price", rawValue);
                formData.append("is_available", status);

                try {
                    const response = await fetch(`http://135.125.238.202:7050/menu/item/${currentItemId}/`, {
                        method: "PUT",
                        headers: {
                            'Authorization': `Bearer ${token}`
                        },
                        body: formData
                    })

                    if (!response.ok) {
                        throw new Error(`خطا در ارسال: ${response.status}`);
                    }

                    const data = await response.json();
                    console.log(" سرور جواب داد:", data);
                    alert("آیتم با موفقیت ذخیره شد!");
                    itemModal.classList.remove("active");
                    loadItem();

                } catch (error) {
                    console.error(" خطا:", error);
                    alert("مشکلی در ذخیره آیتم پیش آمد.");
                }
                itemModal.classList.remove('active');
            });

            // مودال منوی جدید
            const menuModal = document.getElementById('menu-modal');
            const addMenuBtn = document.getElementById('add-menu-btn');
            const closeMenuModalBtn = document.getElementById('close-menu-modal');
            const cancelMenuModalBtn = document.getElementById('cancel-menu-modal');
            const menuForm = document.getElementById('menu-form');

            addMenuBtn.addEventListener('click', () => {
                document.getElementById('menu-modal-title').textContent = 'ایجاد منوی جدید';
                menuModal.classList.add('active');
            });

            closeMenuModalBtn.addEventListener('click', () => {
                menuModal.classList.remove('active');
            });

            cancelMenuModalBtn.addEventListener('click', () => {
                menuModal.classList.remove('active');
            });

            menuForm.addEventListener('submit', async (e) => {
                e.preventDefault();
                const name = document.getElementById('menu-name');
                const image = document.getElementById('menu-image');

                const formData = new FormData();
                formData.append("name", name.value);
                formData.append("image", image.files[0]);

                console.log(formData);

                try {
                    const response = await fetch("http://135.125.238.202:7050/menu/", {
                        method: "POST",
                        headers: {
                            'Authorization': `Bearer ${token}`
                        },
                        body: formData
                    })

                    const data = await response.json();
                    if (response.status === 201) {
                        alert('منو با موفقیت ذخیره شد ');
                        menuModal.classList.remove('active');
                        loadMenus();
                    } else if (response.status === 400) {
                        alert('ارور : تعداد منوی شما نمیتواند بیشتر از 5 عدد باشد ');
                    } else {
                        alert(' خطا در ارتباط ');
                    }
                } catch (error) {
                    console.error(" ارور شما : ", error);
                }
            });

            // بارگذاری اولیه داده‌ها
            loadMenus();
            loadCategory();
            loadItem();
        });

        ///////////////////////////////////////////////////////////////////////
        // مدیریت QR Code - API Functions
        const QR_API_BASE = 'http://135.125.238.202:7050/qr/qrcode';
        const SERVER_BASE_URL = 'http://135.125.238.202:7050'
        // توابع کمکی
        function getAuthHeaders() {
            const token = sessionStorage.getItem('accessToken');
            return {
                'Authorization': `Bearer ${token}`,
                'Content-Type': 'application/json'
            };
        }

        function showAlert(message, type = 'success') {
            const alertClass = type === 'success' ? 'alert-success' : 'alert-danger';
            const alertHtml = `
        <div class="alert ${alertClass} alert-dismissible fade show" role="alert">
            ${message}
            <button type="button" class="close" data-dismiss="alert">
                <span>&times;</span>
            </button>
        </div>
    `;

            // اضافه کردن alert به صفحه
            const alertContainer = document.getElementById('alert-container') || createAlertContainer();
            alertContainer.innerHTML = alertHtml;

            // حذف خودکار بعد از 5 ثانیه
            setTimeout(() => {
                const alert = alertContainer.querySelector('.alert');
                if (alert) {
                    alert.remove();
                }
            }, 5000);
        }

        function createAlertContainer() {
            const container = document.createElement('div');
            container.id = 'alert-container';
            container.style.position = 'fixed';
            container.style.top = '10px';
            container.style.right = '200px';
            container.style.zIndex = '9999';
            container.style.minWidth = '300px';
            document.body.appendChild(container);
            return container;
        }

        // 1. دریافت لیست QR Code ها
        async function loadQRCodes() {
            try {
                const filterMenu = document.getElementById('filter-menu').value;
                const filterActive = document.getElementById('filter-active').checked;

                let url = QR_API_BASE + '/';
                const params = new URLSearchParams();

                if (filterMenu) params.append('menu_id', filterMenu);
                if (filterActive) params.append('is_active', 'true');

                if (params.toString()) {
                    url += '?' + params.toString();
                }

                const response = await fetch(url, {
                    headers: getAuthHeaders()
                });

                if (!response.ok) {
                    throw new Error('خطا در دریافت داده‌ها');
                }

                const qrCodes = await response.json();
                displayQRCodes(qrCodes);
                updateStats(qrCodes);

            } catch (error) {
                console.error('Error loading QR codes:', error);
                showAlert('خطا در بارگذاری QR Code ها', 'error');
            }
        }

        // 2. نمایش QR Code ها در جدول
        function displayQRCodes(qrCodes) {
            const tbody = document.getElementById('qr-table-body');

            if (!qrCodes || qrCodes.length === 0) {
                tbody.innerHTML = `
            <tr>
                <td colspan="8" class="text-center py-4 text-muted">
                    هیچ QR Code یافت نشد
                </td>
            </tr>
        `;
                return;
            }

            tbody.innerHTML = qrCodes.map(qr => {
                // اگر لینک تصویر ناقص بود، base URL رو بهش اضافه کن
                const imageUrl = qr.qr_image.startsWith('http')
                    ? qr.qr_image
                    : SERVER_BASE_URL + qr.qr_image;

                return `
            <tr>
                <td>
                    <img src="${imageUrl}" alt="QR Code" 
                         style="width: 50px; height: 50px; cursor: pointer;"
                         onclick="previewQR(${qr.id})"
                         class="qr-thumbnail">
                </td>
                <td>${qr.name}</td>
                <td>${qr.menu_name || 'منو ' + qr.menu}</td>
                <td>${qr.table_number}</td>
                <td>${qr.scan_count || 0}</td>
                <td>
                    <span class="status ${qr.is_active ? 'completed' : 'canceled'}">
                        ${qr.is_active ? 'فعال' : 'غیرفعال'}
                    </span>
                </td>
                <td>${new Date(qr.created_at).toLocaleDateString('fa-IR')}</td>
                <td>
                    <div class="action-buttons">
                        <button class="btn btn-sm btn-outline" onclick="previewQR(${qr.id})">
                            <i class="fas fa-eye"></i>
                        </button>
                        <button class="btn btn-sm btn-outline" onclick="editQR(${qr.id})">
                            <i class="fas fa-edit"></i>
                        </button>
                        <button class="btn btn-sm ${qr.is_active ? 'btn-warning' : 'btn-success'}" 
                                onclick="toggleQRStatus(${qr.id}, ${!qr.is_active})">
                            ${qr.is_active ? 'غیرفعال' : 'فعال'}
                        </button>
                        <button class="btn btn-sm btn-danger" onclick="deleteQR(${qr.id})">
                            <i class="fas fa-trash"></i>
                        </button>
                    </div>
                </td>
            </tr>
        `;
            }).join('');
        }


        // 3. به‌روزرسانی آمار
        function updateStats(qrCodes) {
            const totalQR = qrCodes.length;
            const activeQR = qrCodes.filter(qr => qr.is_active).length;
            const totalScans = qrCodes.reduce((sum, qr) => sum + (qr.scan_count || 0), 0);

            document.getElementById('total-qr-count').textContent = totalQR;
            document.getElementById('active-qr-count').textContent = activeQR;
            document.getElementById('total-scans').textContent = totalScans;
        }

        // 4. پیش‌نمایش QR Code
        async function previewQR(qrId) {
            try {
                const response = await fetch(`${QR_API_BASE}/${qrId}/`, {
                    headers: getAuthHeaders()
                });

                if (!response.ok) {
                    throw new Error('خطا در دریافت اطلاعات QR');
                }

                const qrData = await response.json();
                showQRPreview(qrData);

            } catch (error) {
                console.error('Error previewing QR:', error);
                showAlert('خطا در نمایش QR Code', 'error');
            }
        }

        function showQRPreview(qrData) {
            const previewSection = document.getElementById('qr-preview-section');
            const qrImage = document.getElementById('qr-preview-image');
            const qrLoading = document.getElementById('qr-loading');
            const qrEmpty = document.getElementById('qr-empty');

            previewSection.style.display = 'block';
            qrLoading.style.display = 'flex';
            qrEmpty.style.display = 'none';
            qrImage.style.display = 'none';

            // آدرس کامل تصویر
            const imageUrl = qrData.qr_image.startsWith('http')
                ? qrData.qr_image
                : SERVER_BASE_URL + qrData.qr_image;

            qrImage.onload = function () {
                qrLoading.style.display = 'none';
                qrImage.style.display = 'block';
            };
            qrImage.onerror = function () {
                qrLoading.style.display = 'none';
                qrEmpty.style.display = 'flex';
            };
            qrImage.src = imageUrl;

            document.getElementById('qr-preview-name').textContent = qrData.name;
            document.getElementById('qr-preview-menu').textContent = qrData.menu_name || 'منو ' + qrData.menu;
            document.getElementById('qr-preview-table').textContent = qrData.table_number;
            document.getElementById('qr-preview-scans').textContent = qrData.scan_count || 0;
            document.getElementById('qr-preview-url').textContent = qrData.qr_url;

            document.getElementById('download-qr-btn').onclick = () => downloadQR(imageUrl, qrData.name);
            document.getElementById('copy-link-btn').onclick = () => copyToClipboard(qrData.qr_url);
        }


        // 5. تولید QR جدید
        async function generateNewQR() {
            try {
                // دریافت لیست منوها برای انتخاب
                const menusResponse = await fetch('http://135.125.238.202:7050/menu/', {
                    headers: getAuthHeaders()
                });

                if (!menusResponse.ok) {
                    throw new Error('خطا در دریافت منوها');
                }

                const menus = await menusResponse.json();

                // نمایش مودال برای دریافت اطلاعات
                const { value: formData } = await Swal.fire({
                    title: 'تولید QR Code جدید',
                    html: `
                <input id="qr-name" class="swal2-input" placeholder="نام (مثال: میز ۱)" required>
                <select id="qr-menu" class="swal2-input" required>
                    <option value="">انتخاب منو</option>
                    ${menus.map(menu => `<option value="${menu.id}">${menu.name}</option>`).join('')}
                </select>
                <input id="qr-table" class="swal2-input" type="number" placeholder="شماره میز" required min="1">
            `,
                    focusConfirm: false,
                    showCancelButton: true,
                    confirmButtonText: 'تولید QR',
                    cancelButtonText: 'انصراف',
                    preConfirm: () => {
                        return {
                            name: document.getElementById('qr-name').value,
                            menu: document.getElementById('qr-menu').value,
                            table_number: document.getElementById('qr-table').value
                        };
                    }
                });

                if (formData) {
                    const response = await fetch(QR_API_BASE + '/', {
                        method: 'POST',
                        headers: getAuthHeaders(),
                        body: JSON.stringify(formData)
                    });

                    if (response.ok) {
                        const newQR = await response.json();
                        showAlert('QR Code با موفقیت تولید شد');
                        loadQRCodes();
                        previewQR(newQR.id);
                    } else {
                        throw new Error('خطا در تولید QR');
                    }
                }

            } catch (error) {
                console.error('Error generating QR:', error);
                showAlert('خطا در تولید QR Code', 'error');
            }
        }

        // 6. ویرایش QR Code
        async function editQR(qrId) {
            try {
                const response = await fetch(`${QR_API_BASE}/${qrId}/`, {
                    headers: getAuthHeaders()
                });

                if (!response.ok) {
                    throw new Error('خطا در دریافت اطلاعات QR');
                }

                const qrData = await response.json();

                const { value: formData } = await Swal.fire({
                    title: 'ویرایش QR Code',
                    html: `
                <input id="edit-qr-name" class="swal2-input" value="${qrData.name}" placeholder="نام" required>
                <input id="edit-qr-table" class="swal2-input" type="number" value="${qrData.table_number}" placeholder="شماره میز" required min="1">
                <select id="edit-qr-active" class="swal2-input">
                    <option value="true" ${qrData.is_active ? 'selected' : ''}>فعال</option>
                    <option value="false" ${!qrData.is_active ? 'selected' : ''}>غیرفعال</option>
                </select>
            `,
                    focusConfirm: false,
                    showCancelButton: true,
                    confirmButtonText: 'ذخیره تغییرات',
                    cancelButtonText: 'انصراف',
                    preConfirm: () => {
                        return {
                            name: document.getElementById('edit-qr-name').value,
                            table_number: parseInt(document.getElementById('edit-qr-table').value),
                            is_active: document.getElementById('edit-qr-active').value === 'true'
                        };
                    }
                });

                if (formData) {
                    const updateResponse = await fetch(`${QR_API_BASE}/${qrId}/`, {
                        method: 'PUT',
                        headers: getAuthHeaders(),
                        body: JSON.stringify(formData)
                    });

                    if (updateResponse.ok) {
                        showAlert('تغییرات با موفقیت ذخیره شد');
                        loadQRCodes();
                    } else {
                        throw new Error('خطا در به‌روزرسانی');
                    }
                }

            } catch (error) {
                console.error('Error editing QR:', error);
                showAlert('خطا در ویرایش QR Code', 'error');
            }
        }

        // 7. تغییر وضعیت QR
        async function toggleQRStatus(qrId, newStatus) {
            try {
                // ابتدا اطلاعات فعلی را دریافت می‌کنیم
                const response = await fetch(`${QR_API_BASE}/${qrId}/`, {
                    headers: getAuthHeaders()
                });

                if (!response.ok) {
                    throw new Error('خطا در دریافت اطلاعات QR');
                }

                const qrData = await response.json();

                const updateData = {
                    name: qrData.name,
                    table_number: qrData.table_number,
                    is_active: newStatus
                };

                const updateResponse = await fetch(`${QR_API_BASE}/${qrId}/`, {
                    method: 'PUT',
                    headers: getAuthHeaders(),
                    body: JSON.stringify(updateData)
                });

                if (updateResponse.ok) {
                    showAlert(`QR Code ${newStatus ? 'فعال' : 'غیرفعال'} شد`);
                    loadQRCodes();
                } else {
                    throw new Error('خطا در تغییر وضعیت');
                }

            } catch (error) {
                console.error('Error toggling QR status:', error);
                showAlert('خطا در تغییر وضعیت QR', 'error');
            }
        }

        // 8. حذف QR Code
        async function deleteQR(qrId) {
            try {
                const { isConfirmed } = await Swal.fire({
                    title: 'آیا مطمئن هستید؟',
                    text: 'این عمل قابل بازگشت نیست!',
                    icon: 'warning',
                    showCancelButton: true,
                    confirmButtonText: 'بله، حذف کن',
                    cancelButtonText: 'انصراف'
                });

                if (isConfirmed) {
                    const response = await fetch(`${QR_API_BASE}/${qrId}/`, {
                        method: 'DELETE',
                        headers: getAuthHeaders()
                    });

                    if (response.ok) {
                        showAlert('QR Code با موفقیت حذف شد');
                        loadQRCodes();
                        // مخفی کردن پیش‌نمایش اگر QR حذف شده در حال نمایش بود
                        document.getElementById('qr-preview-section').style.display = 'none';
                    } else {
                        throw new Error('خطا در حذف QR');
                    }
                }

            } catch (error) {
                console.error('Error deleting QR:', error);
                showAlert('خطا در حذف QR Code', 'error');
            }
        }

        // 9. دانلود QR Code
        async function downloadQR(imageUrl, fileName) {
            try {
                const response = await fetch(imageUrl);
                const blob = await response.blob();
                const url = window.URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `${fileName || 'qrcode'}.png`;
                document.body.appendChild(a);
                a.click();
                window.URL.revokeObjectURL(url);
                document.body.removeChild(a);

                showAlert('QR Code دانلود شد');
            } catch (error) {
                console.error('Error downloading QR:', error);
                showAlert('خطا در دانلود QR Code', 'error');
            }
        }

        // 10. کپی لینک به کلیپ‌بورد
        async function copyToClipboard(text) {
            try {
                await navigator.clipboard.writeText(text);
                showAlert('لینک با موفقیت کپی شد');
            } catch (error) {
                console.error('Error copying to clipboard:', error);
                showAlert('خطا در کپی لینک', 'error');
            }
        }

        // 11. بارگذاری منوها برای فیلتر
        async function loadMenusForFilter() {
            try {
                const response = await fetch('http://135.125.238.202:7050/menu/', {
                    headers: getAuthHeaders()
                });

                if (response.ok) {
                    const menus = await response.json();
                    const filterSelect = document.getElementById('filter-menu');

                    filterSelect.innerHTML = '<option value="">همه منوها</option>' +
                        menus.map(menu => `<option value="${menu.id}">${menu.name}</option>`).join('');
                }
            } catch (error) {
                console.error('Error loading menus for filter:', error);
            }
        }

        // 12. جستجو در QR Code ها
        function setupSearch() {
            const searchInput = document.getElementById('qr-search');
            let searchTimeout;

            searchInput.addEventListener('input', function () {
                clearTimeout(searchTimeout);
                searchTimeout = setTimeout(() => {
                    loadQRCodes();
                }, 500);
            });
        }

        // راه‌اندازی اولیه
        document.addEventListener('DOMContentLoaded', function () {
            // بارگذاری اولیه
            loadMenusForFilter();
            loadQRCodes();

            // رویدادها
            document.getElementById('generate-qr-btn').addEventListener('click', generateNewQR);
            document.getElementById('refresh-qr-btn').addEventListener('click', loadQRCodes);
            document.getElementById('filter-menu').addEventListener('change', loadQRCodes);
            document.getElementById('filter-active').addEventListener('change', loadQRCodes);

            // تنظیم جستجو
            setupSearch();
        });

        // ساخت منو - Drag and Drop
        function initMenuBuilder() {
            // متغیرهای global
            let draggedItem = null;
            let currentEditingItem = null;

            // درگ آیتم‌های ابزار
            const draggableItems = document.querySelectorAll('.menu-item-draggable');
            draggableItems.forEach(item => {
                item.addEventListener('dragstart', function (e) {
                    draggedItem = this.cloneNode(true);
                    e.dataTransfer.setData('text/plain', this.getAttribute('data-type'));
                    this.classList.add('dragging');
                });

                item.addEventListener('dragend', function () {
                    this.classList.remove('dragging');
                });
            });

            // منطقه دراپ
            const droppableArea = document.getElementById('droppable-area');
            if (droppableArea) {
                droppableArea.addEventListener('dragover', function (e) {
                    e.preventDefault();
                    this.classList.add('drop-hover');
                });

                droppableArea.addEventListener('dragleave', function () {
                    this.classList.remove('drop-hover');
                });

                droppableArea.addEventListener('drop', function (e) {
                    e.preventDefault();
                    this.classList.remove('drop-hover');

                    const itemType = e.dataTransfer.getData('text/plain');
                    let newItem;

                    switch (itemType) {
                        case 'category':
                            newItem = createCategoryItem();
                            break;
                        case 'item':
                            newItem = createMenuItem();
                            break;
                        case 'divider':
                            newItem = createDividerItem();
                            break;
                    }

                    // پیدا کردن موقعیت دراپ
                    const dropY = e.clientY;
                    const menuItems = Array.from(this.children);
                    let insertBeforeItem = null;

                    for (const item of menuItems) {
                        const rect = item.getBoundingClientRect();
                        if (dropY < rect.top + rect.height / 2) {
                            insertBeforeItem = item;
                            break;
                        }
                    }

                    if (insertBeforeItem) {
                        this.insertBefore(newItem, insertBeforeItem);
                    } else {
                        this.appendChild(newItem);
                    }

                    // فعال کردن قابلیت ویرایش
                    makeEditable(newItem);
                });
            }

            // ایجاد آیتم‌های منو
            function createCategoryItem() {
                const category = document.createElement('div');
                category.className = 'menu-category';
                category.setAttribute('data-type', 'category');
                category.innerHTML = `
                    <h3 contenteditable="true" class="editable">دسته‌بندی جدید</h3>
                    <div class="menu-items"></div>
                `;
                return category;
            }

            function createMenuItem() {
                const menuItem = document.createElement('div');
                menuItem.className = 'menu-item';
                menuItem.setAttribute('data-type', 'item');
                menuItem.innerHTML = `
                    <div class="item-details">
                        <h4 contenteditable="true" class="editable">آیتم جدید</h4>
                        <p contenteditable="true" class="editable">توضیحات آیتم</p>
                    </div>
                    <span class="item-price" contenteditable="true" class="editable">0 تومان</span>
                `;
                return menuItem;
            }

            function createDividerItem() {
                const divider = document.createElement('div');
                divider.className = 'menu-divider';
                divider.setAttribute('data-type', 'divider');
                return divider;
            }

            // فعال کردن ویرایش آیتم‌ها
            function makeEditable(element) {
                const editables = element.querySelectorAll('.editable');
                editables.forEach(editable => {
                    editable.addEventListener('click', function (e) {
                        e.stopPropagation();
                    });

                    editable.addEventListener('focus', function () {
                        showItemSettings(element);
                    });
                });

                element.addEventListener('click', function () {
                    showItemSettings(element);
                });
            }

            // نمایش پنل تنظیمات آیتم
            function showItemSettings(item) {
                currentEditingItem = item;
                const settingsPanel = document.getElementById('item-settings-panel');
                const itemType = item.getAttribute('data-type');

                document.getElementById('item-type').value = itemType;

                // مخفی کردن همه بخش‌های تنظیمات
                document.getElementById('category-settings').style.display = 'none';
                document.getElementById('item-settings').style.display = 'none';
                document.getElementById('divider-settings').style.display = 'none';

                // نمایش بخش مربوطه
                switch (itemType) {
                    case 'category':
                        document.getElementById('category-settings').style.display = 'block';
                        document.getElementById('category-title').value = item.querySelector('h3').innerText;
                        break;
                    case 'item':
                        document.getElementById('item-settings').style.display = 'block';
                        const itemDetails = item.querySelector('.item-details');
                        document.getElementById('item-name').value = itemDetails.querySelector('h4').innerText;
                        document.getElementById('item-description').value = itemDetails.querySelector('p').innerText;
                        document.getElementById('item-price').value = item.querySelector('.item-price').innerText.replace(' تومان', '');
                        break;
                    case 'divider':
                        document.getElementById('divider-settings').style.display = 'block';
                        break;
                }

                settingsPanel.style.display = 'block';
            }

            // بستن پنل تنظیمات
            const closeSettingsBtn = document.querySelector('.close-settings');
            if (closeSettingsBtn) {
                closeSettingsBtn.addEventListener('click', function () {
                    document.getElementById('item-settings-panel').style.display = 'none';
                });
            }

            // اعمال تغییرات تنظیمات
            const categoryTitle = document.getElementById('category-title');
            if (categoryTitle) {
                categoryTitle.addEventListener('change', function () {
                    if (currentEditingItem) {
                        currentEditingItem.querySelector('h3').innerText = this.value;
                    }
                });
            }

            const itemName = document.getElementById('item-name');
            if (itemName) {
                itemName.addEventListener('change', function () {
                    if (currentEditingItem) {
                        currentEditingItem.querySelector('.item-details h4').innerText = this.value;
                    }
                });
            }

            const itemDescription = document.getElementById('item-description');
            if (itemDescription) {
                itemDescription.addEventListener('change', function () {
                    if (currentEditingItem) {
                        currentEditingItem.querySelector('.item-details p').innerText = this.value;
                    }
                });
            }

            const itemPrice = document.getElementById('item-price');
            if (itemPrice) {
                itemPrice.addEventListener('change', function () {
                    if (currentEditingItem) {
                        currentEditingItem.querySelector('.item-price').innerText = this.value + ' تومان';
                    }
                });
            }

            const dividerStyle = document.getElementById('divider-style');
            if (dividerStyle) {
                dividerStyle.addEventListener('change', function () {
                    if (currentEditingItem) {
                        // تغییر سبک جداکننده
                    }
                });
            }

            const dividerColor = document.getElementById('divider-color');
            if (dividerColor) {
                dividerColor.addEventListener('change', function () {
                    if (currentEditingItem) {
                        currentEditingItem.style.backgroundColor = this.value;
                    }
                });
            }

            // حذف آیتم
            const deleteItemBtn = document.getElementById('delete-item');
            if (deleteItemBtn) {
                deleteItemBtn.addEventListener('click', function () {
                    if (currentEditingItem && confirm('آیا از حذف این آیتم مطمئن هستید؟')) {
                        currentEditingItem.remove();
                        document.getElementById('item-settings-panel').style.display = 'none';
                    }
                });
            }

            // تغییر تنظیمات ظاهری منو
            const menuFont = document.getElementById('menu-font');
            if (menuFont) {
                menuFont.addEventListener('change', function () {
                    document.querySelector('.preview-container').style.fontFamily = this.value;
                });
            }

            const menuBgColor = document.getElementById('menu-bg-color');
            if (menuBgColor) {
                menuBgColor.addEventListener('change', function () {
                    document.querySelector('.preview-container').style.backgroundColor = this.value;
                });
            }

            const menuTextColor = document.getElementById('menu-text-color');
            if (menuTextColor) {
                menuTextColor.addEventListener('change', function () {
                    document.querySelector('.preview-container').style.color = this.value;
                });
            }

            const menuHeadingColor = document.getElementById('menu-heading-color');
            if (menuHeadingColor) {
                menuHeadingColor.addEventListener('change', function () {
                    document.querySelectorAll('.preview-container h2, .preview-container h3').forEach(el => {
                        el.style.color = this.value;
                    });
                });
            }

            const menuStyle = document.getElementById('menu-style');
            if (menuStyle) {
                menuStyle.addEventListener('change', function () {
                    // تغییر سبک کلی منو بر اساس انتخاب کاربر
                });
            }

            // آپلود تصویر زمینه
            const menuBgImage = document.getElementById('menu-bg-image');
            if (menuBgImage) {
                menuBgImage.addEventListener('change', function (e) {
                    const file = e.target.files[0];
                    if (file) {
                        const reader = new FileReader();
                        reader.onload = function (event) {
                            document.querySelector('.preview-container').style.backgroundImage = `url(${event.target.result})`;
                            document.querySelector('.preview-container').style.backgroundSize = 'cover';
                        };
                        reader.readAsDataURL(file);
                    }
                });
            }

            const removeBgBtn = document.getElementById('remove-bg-btn');
            if (removeBgBtn) {
                removeBgBtn.addEventListener('click', function () {
                    document.querySelector('.preview-container').style.backgroundImage = 'none';
                });
            }

            // پیش‌نمایش کامل منو
            const previewMenuBtn = document.getElementById('preview-menu');
            if (previewMenuBtn) {
                previewMenuBtn.addEventListener('click', function () {
                    const previewModal = document.getElementById('full-preview-modal');
                    const previewContent = document.getElementById('full-menu-preview');

                    // کپی منو برای پیش‌نمایش
                    previewContent.innerHTML = document.querySelector('.preview-container').outerHTML;

                    // تنظیم استایل برای پیش‌نمایش
                    previewContent.querySelector('.preview-container').style.width = '100%';
                    previewContent.querySelector('.preview-container').style.border = 'none';
                    previewContent.querySelector('.preview-container').style.padding = '0';

                    previewModal.classList.add('active');
                });
            }

            // ذخیره منو
            const saveMenuBtn = document.getElementById('save-menu');
            if (saveMenuBtn) {
                saveMenuBtn.addEventListener('click', function () {
                    const menuData = {
                        structure: [],
                        design: {
                            font: document.getElementById('menu-font').value,
                            bgColor: document.getElementById('menu-bg-color').value,
                            textColor: document.getElementById('menu-text-color').value,
                            headingColor: document.getElementById('menu-heading-color').value,
                            style: document.getElementById('menu-style').value,
                            bgImage: document.querySelector('.preview-container').style.backgroundImage || 'none'
                        }
                    };

                    // استخراج ساختار منو
                    const menuElements = document.querySelectorAll('#droppable-area > *');
                    menuElements.forEach(el => {
                        const type = el.getAttribute('data-type');
                        let elementData;

                        switch (type) {
                            case 'category':
                                elementData = {
                                    type: 'category',
                                    title: el.querySelector('h3').innerText,
                                    items: []
                                };

                                const items = el.querySelectorAll('.menu-items > .menu-item');
                                items.forEach(item => {
                                    elementData.items.push({
                                        name: item.querySelector('h4').innerText,
                                        description: item.querySelector('p').innerText,
                                        price: item.querySelector('.item-price').innerText
                                    });
                                });
                                break;
                            case 'item':
                                elementData = {
                                    type: 'item',
                                    name: el.querySelector('h4').innerText,
                                    description: el.querySelector('p').innerText,
                                    price: el.querySelector('.item-price').innerText
                                };
                                break;
                            case 'divider':
                                elementData = {
                                    type: 'divider',
                                    style: 'line',
                                    color: '#ddd'
                                };
                                break;
                        }

                        menuData.structure.push(elementData);
                    });

                    // در اینجا می‌توانید menuData را به سرور ارسال کنید
                    console.log('منوی ذخیره شده:', menuData);
                    alert('منو با موفقیت ذخیره شد!');
                });
            }

            // بازنشانی منو
            const resetMenuBtn = document.getElementById('reset-menu');
            if (resetMenuBtn) {
                resetMenuBtn.addEventListener('click', function () {
                    if (confirm('آیا از بازنشانی منو به حالت اولیه مطمئن هستید؟ تمام تغییرات از بین خواهند رفت.')) {
                        const droppableArea = document.getElementById('droppable-area');
                        droppableArea.innerHTML = `
                            <div class="menu-category" data-type="category">
                                <h3 contenteditable="true" class="editable">قهوه‌ها</h3>
                                <div class="menu-items">
                                    <div class="menu-item" data-type="item">
                                        <div class="item-details">
                                            <h4 contenteditable="true" class="editable">اسپرسو</h4>
                                            <p contenteditable="true" class="editable">قهوه اسپرسوی خالص با عطر و طعم غلیظ</p>
                                        </div>
                                        <span class="item-price" contenteditable="true" class="editable">45,000 تومان</span>
                                    </div>
                                    <div class="menu-item" data-type="item">
                                        <div class="item-details">
                                            <h4 contenteditable="true" class="editable">کاپوچینو</h4>
                                            <p contenteditable="true" class="editable">ترکیب اسپرسو، شیر بخار داده شده و فوم شیر</p>
                                        </div>
                                        <span class="item-price" contenteditable="true" class="editable">55,000 تومان</span>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="menu-divider" data-type="divider"></div>
                            
                            <div class="menu-category" data-type="category">
                                <h3 contenteditable="true" class="editable">دسرها</h3>
                                <div class="menu-items">
                                    <div class="menu-item" data-type="item">
                                        <div class="item-details">
                                            <h4 contenteditable="true" class="editable">چیزکیک</h4>
                                            <p contenteditable="true" class="editable">چیزکیک کلاسیک با توت فرنگی تازه</p>
                                        </div>
                                        <span class="item-price" contenteditable="true" class="editable">75,000 تومان</span>
                                    </div>
                                </div>
                            </div>
                        `;

                        // بازنشانی تنظیمات ظاهری
                        document.getElementById('menu-font').value = 'IranSans, sans-serif';
                        document.getElementById('menu-bg-color').value = '#ffffff';
                        document.getElementById('menu-text-color').value = '#333333';
                        document.getElementById('menu-heading-color').value = '#6F4E37';
                        document.getElementById('menu-style').value = 'classic';
                        document.querySelector('.preview-container').style.backgroundImage = 'none';

                        // اعمال تغییرات
                        document.querySelector('.preview-container').style.fontFamily = 'IranSans, sans-serif';
                        document.querySelector('.preview-container').style.backgroundColor = '#ffffff';
                        document.querySelector('.preview-container').style.color = '#333333';
                        document.querySelectorAll('.preview-container h2, .preview-container h3').forEach(el => {
                            el.style.color = '#6F4E37';
                        });

                        // فعال کردن ویرایش برای آیتم‌های جدید
                        document.querySelectorAll('#droppable-area > *').forEach(item => {
                            makeEditable(item);
                        });
                    }
                });
            }

            // فعال کردن ویرایش برای آیتم‌های پیش‌فرض
            document.querySelectorAll('#droppable-area > *').forEach(item => {
                makeEditable(item);
            });
        }

        // فراخوانی تابع هنگام لود صفحه
        if (document.getElementById('menu-builder')) {
            initMenuBuilder();
        }
    </script>
</body>

</html>